commit 1f1c996eb1f0f3e2193fba0075f62ccd04e3c0c3
Author: Musachy Barroso <musachy@apache.org>
Date:   Fri Aug 22 15:22:56 2008 +0000

    WW-2779  Directory traversal vulnerability while serving static content
    
    git-svn-id: https://svn.apache.org/repos/asf/struts/struts2/trunk@688095 13f79535-47bb-0310-9956-ffa450edef68

diff --git a/core/src/test/java/org/apache/struts2/dispatcher/StaticContentLoaderTest.java b/core/src/test/java/org/apache/struts2/dispatcher/StaticContentLoaderTest.java
index d1c1e893c..607394f9a 100644
--- a/core/src/test/java/org/apache/struts2/dispatcher/StaticContentLoaderTest.java
+++ b/core/src/test/java/org/apache/struts2/dispatcher/StaticContentLoaderTest.java
@@ -69,6 +69,30 @@ public class StaticContentLoaderTest extends TestCase {
         assertEquals(0, res.getContentLength());
     }
 
+    public void testInvalidRersources2() throws IOException {
+        contentLoader.findStaticResource("/struts/..", req, res);
+        assertEquals(HttpServletResponse.SC_NOT_FOUND, res.getStatus());
+        assertEquals(0, res.getContentLength());
+    }
+
+    public void testInvalidRersources3() throws IOException {
+        contentLoader.findStaticResource("/struts/../othertest.properties", req, res);
+        assertEquals(HttpServletResponse.SC_NOT_FOUND, res.getStatus());
+        assertEquals(0, res.getContentLength());
+    }
+
+    public void testInvalidRersources4() throws IOException {
+        contentLoader.findStaticResource("/struts/..%252f", req, res);
+        assertEquals(HttpServletResponse.SC_NOT_FOUND, res.getStatus());
+        assertEquals(0, res.getContentLength());
+    }
+
+    public void testInvalidRersources5() throws IOException {
+        contentLoader.findStaticResource("/struts/..%252fothertest.properties", req, res);
+        assertEquals(HttpServletResponse.SC_NOT_FOUND, res.getStatus());
+        assertEquals(0, res.getContentLength());
+    }
+
     @Override
     protected void setUp() throws Exception {
         super.setUp();