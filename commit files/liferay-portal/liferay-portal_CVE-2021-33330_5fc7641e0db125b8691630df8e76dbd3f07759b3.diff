commit 5fc7641e0db125b8691630df8e76dbd3f07759b3
Author: Carlos Sierra Andr√©s <carlos.sierra@liferay.com>
Date:   Thu May 21 10:04:37 2020 +0200

    LPS-113348 Null check

diff --git a/modules/apps/oauth2-provider/oauth2-provider-scope-liferay-api/src/main/java/com/liferay/oauth2/provider/scope/liferay/OAuth2ProviderScopeLiferayAccessControlContext.java b/modules/apps/oauth2-provider/oauth2-provider-scope-liferay-api/src/main/java/com/liferay/oauth2/provider/scope/liferay/OAuth2ProviderScopeLiferayAccessControlContext.java
index 90c2a3455572..20d81271ccdc 100644
--- a/modules/apps/oauth2-provider/oauth2-provider-scope-liferay-api/src/main/java/com/liferay/oauth2/provider/scope/liferay/OAuth2ProviderScopeLiferayAccessControlContext.java
+++ b/modules/apps/oauth2-provider/oauth2-provider-scope-liferay-api/src/main/java/com/liferay/oauth2/provider/scope/liferay/OAuth2ProviderScopeLiferayAccessControlContext.java
@@ -29,11 +29,18 @@ public class OAuth2ProviderScopeLiferayAccessControlContext {
 		AccessControlContext accessControlContext =
 			AccessControlUtil.getAccessControlContext();
 
+		if (accessControlContext == null) {
+			return false;
+		}
+
 		AuthVerifierResult authVerifierResult =
 			accessControlContext.getAuthVerifierResult();
 
-		if ((authVerifierResult != null) &&
-			AuthVerifierResult.State.SUCCESS.equals(
+		if (authVerifierResult == null) {
+			return false;
+		}
+
+		if (AuthVerifierResult.State.SUCCESS.equals(
 				authVerifierResult.getState())) {
 
 			String authType = MapUtil.getString(