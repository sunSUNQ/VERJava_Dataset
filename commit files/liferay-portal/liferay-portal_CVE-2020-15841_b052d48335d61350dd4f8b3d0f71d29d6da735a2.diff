commit b052d48335d61350dd4f8b3d0f71d29d6da735a2
Author: Tomáš Polešovský <tomas.polesovsky@liferay.com>
Date:   Wed Oct 30 16:23:37 2019 +0100

    LPS-104370 Stacktrace is unnecessary here.

diff --git a/modules/apps/portal-settings/portal-settings-authentication-ldap-web/src/main/java/com/liferay/portal/settings/authentication/ldap/web/internal/portlet/action/PortalSettingsTestLDAPConnectionMVCRenderCommand.java b/modules/apps/portal-settings/portal-settings-authentication-ldap-web/src/main/java/com/liferay/portal/settings/authentication/ldap/web/internal/portlet/action/PortalSettingsTestLDAPConnectionMVCRenderCommand.java
index 91188e761a67..deb925911f49 100644
--- a/modules/apps/portal-settings/portal-settings-authentication-ldap-web/src/main/java/com/liferay/portal/settings/authentication/ldap/web/internal/portlet/action/PortalSettingsTestLDAPConnectionMVCRenderCommand.java
+++ b/modules/apps/portal-settings/portal-settings-authentication-ldap-web/src/main/java/com/liferay/portal/settings/authentication/ldap/web/internal/portlet/action/PortalSettingsTestLDAPConnectionMVCRenderCommand.java
@@ -15,7 +15,10 @@
 package com.liferay.portal.settings.authentication.ldap.web.internal.portlet.action;
 
 import com.liferay.configuration.admin.constants.ConfigurationAdminPortletKeys;
+import com.liferay.portal.kernel.log.Log;
+import com.liferay.portal.kernel.log.LogFactoryUtil;
 import com.liferay.portal.kernel.portlet.bridges.mvc.MVCRenderCommand;
+import com.liferay.portal.kernel.portlet.bridges.mvc.MVCRenderConstants;
 import com.liferay.portal.kernel.security.auth.AuthTokenUtil;
 import com.liferay.portal.kernel.security.auth.PrincipalException;
 import com.liferay.portal.kernel.util.Portal;
@@ -51,14 +54,21 @@ public class PortalSettingsTestLDAPConnectionMVCRenderCommand
 			AuthTokenUtil.checkCSRFToken(
 				_portal.getOriginalServletRequest(
 					_portal.getHttpServletRequest(renderRequest)),
-				PortalSettingsTestLDAPConnectionMVCRenderCommand.class.
-					getName());
+				getClass().getName());
+
+			return super.render(renderRequest, renderResponse);
 		}
 		catch (PrincipalException pe) {
-			throw new PortletException(pe);
+			if (_log.isDebugEnabled()) {
+				_log.debug(
+					"Unable to test LDAP connection: " + pe.getMessage(), pe);
+			}
+			else if (_log.isWarnEnabled()) {
+				_log.warn("Unable to test LDAP connection: " + pe.getMessage());
+			}
 		}
 
-		return super.render(renderRequest, renderResponse);
+		return MVCRenderConstants.MVC_PATH_VALUE_SKIP_DISPATCH;
 	}
 
 	@Override
@@ -77,6 +87,9 @@ public class PortalSettingsTestLDAPConnectionMVCRenderCommand
 	private static final String _JSP_PATH =
 		"/com.liferay.portal.settings.web/test_ldap_connection.jsp";
 
+	private static final Log _log = LogFactoryUtil.getLog(
+		PortalSettingsTestLDAPConnectionMVCRenderCommand.class);
+
 	@Reference
 	private Portal _portal;
 