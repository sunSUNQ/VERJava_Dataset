commit d7dc329b4e12dd1c1566a7c9da8e48a1ed05ee07
Author: Tomáš Polešovský <tomas.polesovsky@liferay.com>
Date:   Mon Jan 20 16:11:52 2020 +0100

    LPS-57105 Test

diff --git a/portal-impl/test/unit/com/liferay/portal/util/PortalImplUnitTest.java b/portal-impl/test/unit/com/liferay/portal/util/PortalImplUnitTest.java
index 33b723f3918e..3d817c5c50fb 100644
--- a/portal-impl/test/unit/com/liferay/portal/util/PortalImplUnitTest.java
+++ b/portal-impl/test/unit/com/liferay/portal/util/PortalImplUnitTest.java
@@ -21,6 +21,7 @@ import com.liferay.portal.kernel.test.ReflectionTestUtil;
 import com.liferay.portal.kernel.util.HttpUtil;
 import com.liferay.portal.kernel.util.PropsUtil;
 import com.liferay.portal.kernel.util.ProxyUtil;
+import com.liferay.portal.kernel.util.StringBundler;
 import com.liferay.portal.kernel.util.WebKeys;
 import com.liferay.registry.BasicRegistryImpl;
 import com.liferay.registry.Registry;
@@ -621,6 +622,25 @@ public class PortalImplUnitTest {
 			_portalImpl.isValidResourceId("%5cWEB-INF%5cweb.xml"));
 		Assert.assertFalse(
 			_portalImpl.isValidResourceId("%255cWEB-INF%255cweb.xml"));
+
+		Assert.assertTrue(_portalImpl.isValidResourceId("%25252525252525252f"));
+
+		StringBundler sb = new StringBundler();
+
+		sb.append("%");
+
+		for (int i = 0; i < 100000; i++) {
+			sb.append("25");
+		}
+
+		sb.append("2f");
+
+		try {
+			Assert.assertFalse(_portalImpl.isValidResourceId(sb.toString()));
+		}
+		catch (OutOfMemoryError oome) {
+			Assert.fail();
+		}
 	}
 
 	@Test