commit 1c8cc935ad270d2e715bf0e215570f9c381b57c2
Author: Marta Medio <marta.medio@liferay.com>
Date:   Wed Jun 17 11:05:45 2020 +0200

    LPS-113348 Adapt existing test infrastructure for CORS Preflight

diff --git a/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/AllowRestrictedHeadersCallable.java b/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/AllowRestrictedHeadersCallable.java
index c6e326cb11bd..3fcb3168a605 100644
--- a/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/AllowRestrictedHeadersCallable.java
+++ b/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/AllowRestrictedHeadersCallable.java
@@ -25,6 +25,8 @@ import java.net.URL;
 import java.util.List;
 import java.util.Map;
 
+import javax.ws.rs.HttpMethod;
+
 /**
  * @author Preston Crary
  */
@@ -50,7 +52,8 @@ public class AllowRestrictedHeadersCallable
 
 			httpURLConnection.setRequestProperty("Origin", _origin);
 			httpURLConnection.setRequestProperty(
-				_ACCESS_CONTROL_REQUEST_METHOD, _method);
+				_ACCESS_CONTROL_REQUEST_METHOD, HttpMethod.GET);
+			httpURLConnection.setRequestMethod(_method);
 
 			if (_authenticate) {
 				String encodedUserNameAndPassword = Base64.encode(
diff --git a/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/BaseCORSClientTestCase.java b/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/BaseCORSClientTestCase.java
index c29215e3f345..e4da00064413 100644
--- a/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/BaseCORSClientTestCase.java
+++ b/modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/BaseCORSClientTestCase.java
@@ -45,6 +45,7 @@ import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.Future;
 import java.util.concurrent.TimeUnit;
 
+import javax.ws.rs.HttpMethod;
 import javax.ws.rs.core.Application;
 
 import org.junit.AfterClass;
@@ -107,7 +108,10 @@ public abstract class BaseCORSClientTestCase {
 			Assert.assertNull(results[0]);
 		}
 
-		Assert.assertEquals("get", results[1]);
+		if (!HttpMethod.OPTIONS.equals(method)) {
+			Assert.assertNotEquals(StringPool.BLANK, results[1]);
+		}
+
 		Assert.assertEquals("200", results[2]);
 	}
 
@@ -136,7 +140,10 @@ public abstract class BaseCORSClientTestCase {
 			Assert.assertNull(results[0]);
 		}
 
-		Assert.assertNotEquals(StringPool.BLANK, results[1]);
+		if (!HttpMethod.OPTIONS.equals(method)) {
+			Assert.assertNotEquals(StringPool.BLANK, results[1]);
+		}
+
 		Assert.assertEquals("200", results[2]);
 	}
 