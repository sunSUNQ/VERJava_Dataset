[{"cve_id": "liferay-portal", "added_line": [], "removed_line": [{"source_line_num": 51, "source_line_code": "@Test"}, {"source_line_num": 52, "source_line_code": "public void testCheckClassIsRestricted() {"}, {"source_line_num": 53, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 54, "source_line_code": "new RestrictedLiferayObjectWrapper(null, null, null),"}, {"source_line_num": 55, "source_line_code": "TestLiferayObject.class, null);"}, {"source_line_num": 57, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 58, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 59, "source_line_code": "new String[] {TestLiferayObject.class.getName()},"}, {"source_line_num": 60, "source_line_code": "new String[] {TestLiferayObject.class.getName()}, null),"}, {"source_line_num": 61, "source_line_code": "TestLiferayObject.class, null);"}, {"source_line_num": 63, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 64, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 65, "source_line_code": "null, new String[] {\"java.lang.String\"}, null),"}, {"source_line_num": 66, "source_line_code": "TestLiferayObject.class, null);"}, {"source_line_num": 68, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 69, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 70, "source_line_code": "null, new String[] {\"com.liferay.portal.cache\"}, null),"}, {"source_line_num": 71, "source_line_code": "TestLiferayObject.class, null);"}, {"source_line_num": 73, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 74, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 75, "source_line_code": "null, new String[] {TestLiferayObject.class.getName()}, null),"}, {"source_line_num": 76, "source_line_code": "TestLiferayObject.class,"}, {"source_line_num": 77, "source_line_code": "StringBundler.concat("}, {"source_line_num": 78, "source_line_code": "\"Denied resolving class \", TestLiferayObject.class.getName(),"}, {"source_line_num": 79, "source_line_code": "\" by \", TestLiferayObject.class.getName()));"}, {"source_line_num": 81, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 82, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 83, "source_line_code": "null, new String[] {\"com.liferay.portal.template.freemarker\"},"}, {"source_line_num": 84, "source_line_code": "null),"}, {"source_line_num": 85, "source_line_code": "TestLiferayObject.class,"}, {"source_line_num": 86, "source_line_code": "StringBundler.concat("}, {"source_line_num": 87, "source_line_code": "\"Denied resolving class \", TestLiferayObject.class.getName(),"}, {"source_line_num": 88, "source_line_code": "\" by com.liferay.portal.template.freemarker\"));"}, {"source_line_num": 90, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 91, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 92, "source_line_code": "null, new String[] {\"com.liferay.portal.template.freemarker\"},"}, {"source_line_num": 93, "source_line_code": "null),"}, {"source_line_num": 94, "source_line_code": "byte.class, null);"}, {"source_line_num": 97, "source_line_code": "@Test"}, {"source_line_num": 98, "source_line_code": "public void testCheckClassIsRestrictedWithNoContextClassloader() {"}, {"source_line_num": 99, "source_line_code": "Thread thread = Thread.currentThread();"}, {"source_line_num": 101, "source_line_code": "ClassLoader contextClassLoader = thread.getContextClassLoader();"}, {"source_line_num": 103, "source_line_code": "thread.setContextClassLoader(null);"}, {"source_line_num": 105, "source_line_code": "try {"}, {"source_line_num": 106, "source_line_code": "_testCheckClassIsRestricted("}, {"source_line_num": 107, "source_line_code": "new RestrictedLiferayObjectWrapper("}, {"source_line_num": 108, "source_line_code": "new String[] {TestLiferayObject.class.getName()},"}, {"source_line_num": 109, "source_line_code": "new String[] {TestLiferayObject.class.getName()}, null),"}, {"source_line_num": 110, "source_line_code": "TestLiferayObject.class, null);"}, {"source_line_num": 112, "source_line_code": "finally {"}, {"source_line_num": 113, "source_line_code": "thread.setContextClassLoader(contextClassLoader);"}], "filename": "modules/apps/portal-template/portal-template-freemarker/src/test/java/com/liferay/portal/template/freemarker/internal/RestrictedLiferayObjectWrapperTest.java", "patch_func": "testProcessTemplate1", "diff_file": "liferay-portal_CVE-2020-13445_ae27ad5dfe58c11697101d6d7fe35d38f7bcb4ca.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]