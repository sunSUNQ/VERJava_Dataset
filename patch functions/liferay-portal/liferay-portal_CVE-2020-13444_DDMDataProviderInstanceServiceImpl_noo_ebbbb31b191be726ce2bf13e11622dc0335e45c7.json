[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 245, "target_line_code": "@Reference(unbind = \"-\")"}, {"target_line_num": 246, "target_line_code": "protected void setJSONFactory(JSONFactory jsonFactory) {"}, {"target_line_num": 247, "target_line_code": "_jsonFactory = jsonFactory;"}, {"target_line_num": 250, "target_line_code": "private JSONArray _filterFieldValues(JSONArray fieldValuesJSONArray) {"}, {"target_line_num": 251, "target_line_code": "JSONArray filteredFieldValuesJSONArray = _jsonFactory.createJSONArray();"}, {"target_line_num": 253, "target_line_code": "Iterator iterator = fieldValuesJSONArray.iterator();"}, {"target_line_num": 255, "target_line_code": "while (iterator.hasNext()) {"}, {"target_line_num": 256, "target_line_code": "JSONObject fieldValueJSONObject = (JSONObject)iterator.next();"}, {"target_line_num": 258, "target_line_code": "String fieldValueName = fieldValueJSONObject.getString(\"name\");"}, {"target_line_num": 260, "target_line_code": "if (StringUtil.equals(fieldValueName, \"password\") ||"}, {"target_line_num": 261, "target_line_code": "StringUtil.equals(fieldValueName, \"username\")) {"}, {"target_line_num": 263, "target_line_code": "continue;"}, {"target_line_num": 266, "target_line_code": "filteredFieldValuesJSONArray.put(fieldValueJSONObject);"}, {"target_line_num": 269, "target_line_code": "return filteredFieldValuesJSONArray;"}, {"target_line_num": 272, "target_line_code": "private DDMDataProviderInstance _transformDDMDataProviderInstance("}, {"target_line_num": 273, "target_line_code": "DDMDataProviderInstance ddmDataProviderInstance) {"}, {"target_line_num": 275, "target_line_code": "try {"}, {"target_line_num": 276, "target_line_code": "JSONObject definitionJSONObject = _jsonFactory.createJSONObject("}, {"target_line_num": 277, "target_line_code": "ddmDataProviderInstance.getDefinition());"}, {"target_line_num": 279, "target_line_code": "if (!definitionJSONObject.has(\"fieldValues\")) {"}, {"target_line_num": 280, "target_line_code": "return ddmDataProviderInstance;"}, {"target_line_num": 283, "target_line_code": "JSONArray fieldValuesJSONArray = definitionJSONObject.getJSONArray("}, {"target_line_num": 284, "target_line_code": "\"fieldValues\");"}, {"target_line_num": 286, "target_line_code": "definitionJSONObject.put("}, {"target_line_num": 287, "target_line_code": "\"fieldValues\", _filterFieldValues(fieldValuesJSONArray));"}, {"target_line_num": 289, "target_line_code": "ddmDataProviderInstance.setDefinition("}, {"target_line_num": 290, "target_line_code": "definitionJSONObject.toJSONString());"}, {"target_line_num": 292, "target_line_code": "catch (Exception exception) {"}, {"target_line_num": 293, "target_line_code": "_log.error(exception, exception);"}, {"target_line_num": 296, "target_line_code": "return ddmDataProviderInstance;"}, {"target_line_num": 299, "target_line_code": "private static final Log _log = LogFactoryUtil.getLog("}, {"target_line_num": 300, "target_line_code": "DDMDataProviderInstanceServiceImpl.class);"}, {"target_line_num": 308, "target_line_code": "@Reference"}, {"target_line_num": 309, "target_line_code": "private JSONFactory _jsonFactory;"}], "removed_line": [], "filename": "modules/apps/dynamic-data-mapping/dynamic-data-mapping-service/src/main/java/com/liferay/dynamic/data/mapping/service/impl/DDMDataProviderInstanceServiceImpl.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2020-13444_ebbbb31b191be726ce2bf13e11622dc0335e45c7.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]