[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 70, "target_line_code": "@Test"}, {"target_line_num": 71, "target_line_code": "public void testPreflightCORSRequest() throws Exception {"}, {"target_line_num": 72, "target_line_code": "WebTarget webTarget = getJsonWebTarget(\"user\", \"get-current-user\");"}, {"target_line_num": 74, "target_line_code": "String tokenString = getToken("}, {"target_line_num": 75, "target_line_code": "\"oauthTestApplicationRO\", null,"}, {"target_line_num": 76, "target_line_code": "getResourceOwnerPasswordBiFunction(\"test@liferay.com\", \"test\"),"}, {"target_line_num": 77, "target_line_code": "this::parseTokenString);"}, {"target_line_num": 79, "target_line_code": "Invocation.Builder invocationBuilder = authorize("}, {"target_line_num": 80, "target_line_code": "webTarget.request(), tokenString);"}, {"target_line_num": 82, "target_line_code": "invocationBuilder.header("}, {"target_line_num": 83, "target_line_code": "\"Access-Control-Request-Method\", HttpMethod.OPTIONS);"}, {"target_line_num": 84, "target_line_code": "invocationBuilder.header(\"Origin\", _TEST_CORS_URI);"}, {"target_line_num": 86, "target_line_code": "Response response = invocationBuilder.options();"}, {"target_line_num": 88, "target_line_code": "String corsHeaderString = response.getHeaderString("}, {"target_line_num": 89, "target_line_code": "\"Access-Control-Allow-Origin\");"}, {"target_line_num": 91, "target_line_code": "Assert.assertEquals(_TEST_CORS_URI, corsHeaderString);"}], "removed_line": [], "filename": "modules/apps/oauth2-provider/oauth2-provider-test/src/testIntegration/java/com/liferay/oauth2/provider/client/test/CORSApplicationClientTest.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_b83c32b03707da7b3e7ec4e573515e5760d51bf8.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]