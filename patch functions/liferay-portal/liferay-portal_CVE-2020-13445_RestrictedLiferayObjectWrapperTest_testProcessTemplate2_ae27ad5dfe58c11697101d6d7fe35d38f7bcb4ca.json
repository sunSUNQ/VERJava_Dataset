[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 97, "target_line_code": "@Test"}, {"target_line_num": 98, "target_line_code": "public void testIsRestricted() {"}, {"target_line_num": 99, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 100, "target_line_code": "_isRestricted("}, {"target_line_num": 101, "target_line_code": "new RestrictedLiferayObjectWrapper(null, null, null),"}, {"target_line_num": 102, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 104, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 105, "target_line_code": "_isRestricted("}, {"target_line_num": 106, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 107, "target_line_code": "new String[] {TestLiferayObject.class.getName()},"}, {"target_line_num": 108, "target_line_code": "new String[] {TestLiferayObject.class.getName()}, null),"}, {"target_line_num": 109, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 111, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 112, "target_line_code": "_isRestricted("}, {"target_line_num": 113, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 114, "target_line_code": "null, new String[] {\"java.lang.String\"}, null),"}, {"target_line_num": 115, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 117, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 118, "target_line_code": "_isRestricted("}, {"target_line_num": 119, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 120, "target_line_code": "null, new String[] {\"com.liferay.portal.cache\"}, null),"}, {"target_line_num": 121, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 123, "target_line_code": "Assert.assertTrue("}, {"target_line_num": 124, "target_line_code": "_isRestricted("}, {"target_line_num": 125, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 126, "target_line_code": "null, new String[] {TestLiferayObject.class.getName()},"}, {"target_line_num": 127, "target_line_code": "null),"}, {"target_line_num": 128, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 130, "target_line_code": "Assert.assertTrue("}, {"target_line_num": 131, "target_line_code": "_isRestricted("}, {"target_line_num": 132, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 133, "target_line_code": "null,"}, {"target_line_num": 134, "target_line_code": "new String[] {\"com.liferay.portal.template.freemarker\"},"}, {"target_line_num": 135, "target_line_code": "null),"}, {"target_line_num": 136, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 138, "target_line_code": "Assert.assertTrue("}, {"target_line_num": 139, "target_line_code": "_isRestricted("}, {"target_line_num": 140, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 141, "target_line_code": "null, new String[] {\"com.liferay.portal.*\"}, null),"}, {"target_line_num": 142, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 144, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 145, "target_line_code": "_isRestricted("}, {"target_line_num": 146, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 147, "target_line_code": "null,"}, {"target_line_num": 148, "target_line_code": "new String[] {\"com.liferay.portal.template.freemarker\"},"}, {"target_line_num": 149, "target_line_code": "null),"}, {"target_line_num": 150, "target_line_code": "byte.class));"}, {"target_line_num": 152, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 153, "target_line_code": "_isRestricted("}, {"target_line_num": 154, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 155, "target_line_code": "null,"}, {"target_line_num": 156, "target_line_code": "new String[] {\"com.liferay.portal.template.freemarker\"},"}, {"target_line_num": 157, "target_line_code": "null),"}, {"target_line_num": 158, "target_line_code": "byte.class));"}, {"target_line_num": 161, "target_line_code": "@Test"}, {"target_line_num": 162, "target_line_code": "public void testIsRestrictedWithNoContextClassloader() {"}, {"target_line_num": 163, "target_line_code": "Thread thread = Thread.currentThread();"}, {"target_line_num": 165, "target_line_code": "ClassLoader contextClassLoader = thread.getContextClassLoader();"}, {"target_line_num": 167, "target_line_code": "thread.setContextClassLoader(null);"}, {"target_line_num": 169, "target_line_code": "try {"}, {"target_line_num": 170, "target_line_code": "Assert.assertFalse("}, {"target_line_num": 171, "target_line_code": "_isRestricted("}, {"target_line_num": 172, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 173, "target_line_code": "new String[] {TestLiferayObject.class.getName()},"}, {"target_line_num": 174, "target_line_code": "new String[] {TestLiferayObject.class.getName()}, null),"}, {"target_line_num": 175, "target_line_code": "TestLiferayObject.class));"}, {"target_line_num": 177, "target_line_code": "finally {"}, {"target_line_num": 178, "target_line_code": "thread.setContextClassLoader(contextClassLoader);"}, {"target_line_num": 182, "target_line_code": "@Test"}, {"target_line_num": 183, "target_line_code": "public void testRestrictedClass() throws Exception {"}, {"target_line_num": 184, "target_line_code": "RestrictedLiferayObjectWrapper restrictedLiferayObjectWrapper ="}, {"target_line_num": 185, "target_line_code": "new RestrictedLiferayObjectWrapper("}, {"target_line_num": 186, "target_line_code": "null, new String[] {TestLiferayMethodObject.class.getName()},"}, {"target_line_num": 187, "target_line_code": "null);"}, {"target_line_num": 189, "target_line_code": "TemplateModel templateModel = restrictedLiferayObjectWrapper.wrap("}, {"target_line_num": 190, "target_line_code": "new TestLiferayMethodObject(\"test\"));"}, {"target_line_num": 192, "target_line_code": "Assert.assertThat("}, {"target_line_num": 193, "target_line_code": "templateModel,"}, {"target_line_num": 194, "target_line_code": "CoreMatchers.instanceOf(LiferayFreeMarkerStringModel.class));"}, {"target_line_num": 196, "target_line_code": "LiferayFreeMarkerStringModel liferayFreeMarkerStringModel ="}, {"target_line_num": 197, "target_line_code": "(LiferayFreeMarkerStringModel)templateModel;"}, {"target_line_num": 199, "target_line_code": "_testRestrictedMethodNames(liferayFreeMarkerStringModel, \"name\");"}, {"target_line_num": 200, "target_line_code": "_testRestrictedMethodNames(liferayFreeMarkerStringModel, \"Name\");"}, {"target_line_num": 201, "target_line_code": "_testRestrictedMethodNames(liferayFreeMarkerStringModel, \"getName\");"}, {"target_line_num": 202, "target_line_code": "_testRestrictedMethodNames(liferayFreeMarkerStringModel, \"getname\");"}, {"target_line_num": 203, "target_line_code": "_testRestrictedMethodNames("}, {"target_line_num": 204, "target_line_code": "liferayFreeMarkerStringModel, \"generateName\");"}], "removed_line": [], "filename": "modules/apps/portal-template/portal-template-freemarker/src/test/java/com/liferay/portal/template/freemarker/internal/RestrictedLiferayObjectWrapperTest.java", "patch_func": "testProcessTemplate2", "diff_file": "liferay-portal_CVE-2020-13445_ae27ad5dfe58c11697101d6d7fe35d38f7bcb4ca.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]