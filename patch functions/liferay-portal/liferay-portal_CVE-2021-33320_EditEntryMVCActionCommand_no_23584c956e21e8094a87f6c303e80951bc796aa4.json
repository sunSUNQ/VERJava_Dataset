[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 21, "target_line_code": "import com.liferay.portal.kernel.captcha.CaptchaException;"}, {"target_line_num": 22, "target_line_code": "import com.liferay.portal.kernel.captcha.CaptchaTextException;"}, {"target_line_num": 85, "target_line_code": "catch (CaptchaException captchaException) {"}, {"target_line_num": 86, "target_line_code": "ThemeDisplay themeDisplay ="}, {"target_line_num": 87, "target_line_code": "(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);"}, {"target_line_num": 89, "target_line_code": "jsonObject.put("}, {"target_line_num": 90, "target_line_code": "\"error\","}, {"target_line_num": 91, "target_line_code": "LanguageUtil.get("}, {"target_line_num": 92, "target_line_code": "themeDisplay.getRequest(),"}, {"target_line_num": 93, "target_line_code": "_getCaptchaExceptionErrorMessageKey(captchaException)));"}, {"target_line_num": 116, "target_line_code": "private String _getCaptchaExceptionErrorMessageKey("}, {"target_line_num": 117, "target_line_code": "CaptchaException captchaException) {"}, {"target_line_num": 119, "target_line_code": "if (captchaException instanceof CaptchaTextException) {"}, {"target_line_num": 120, "target_line_code": "return \"text-verification-failed\";"}, {"target_line_num": 123, "target_line_code": "return \"captcha-verification-failed\";"}], "removed_line": [], "filename": "modules/apps/flags/flags-web/src/main/java/com/liferay/flags/web/internal/portlet/action/EditEntryMVCActionCommand.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33320_23584c956e21e8094a87f6c303e80951bc796aa4.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]