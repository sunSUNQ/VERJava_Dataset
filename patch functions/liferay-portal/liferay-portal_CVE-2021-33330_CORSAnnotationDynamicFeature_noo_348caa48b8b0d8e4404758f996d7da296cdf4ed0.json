[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 108, "target_line_code": "private static class CORSContainerRequestFilter"}, {"target_line_num": 109, "target_line_code": "implements ContainerResponseFilter {"}, {"target_line_num": 111, "target_line_code": "public CORSContainerRequestFilter(CORSSupport corsSupport) {"}, {"target_line_num": 112, "target_line_code": "_corsSupport = corsSupport;"}, {"target_line_num": 115, "target_line_code": "@Override"}, {"target_line_num": 116, "target_line_code": "public void filter("}, {"target_line_num": 117, "target_line_code": "ContainerRequestContext containerRequestContext,"}, {"target_line_num": 118, "target_line_code": "ContainerResponseContext containerResponseContext)"}, {"target_line_num": 119, "target_line_code": "throws IOException {"}, {"target_line_num": 121, "target_line_code": "MultivaluedMap<String, String> headers ="}, {"target_line_num": 122, "target_line_code": "containerRequestContext.getHeaders();"}, {"target_line_num": 124, "target_line_code": "if (OAuth2ProviderScopeLiferayAccessControlContext."}, {"target_line_num": 125, "target_line_code": "isOAuth2AuthVerified() &&"}, {"target_line_num": 126, "target_line_code": "_corsSupport.isCORSRequest(headers::getFirst) &&"}, {"target_line_num": 127, "target_line_code": "_corsSupport.isValidCORSRequest("}, {"target_line_num": 128, "target_line_code": "containerRequestContext.getMethod(), headers::getFirst)) {"}, {"target_line_num": 130, "target_line_code": "MultivaluedMap<String, Object> responseHeaders ="}, {"target_line_num": 131, "target_line_code": "containerResponseContext.getHeaders();"}, {"target_line_num": 133, "target_line_code": "_corsSupport.writeResponseHeaders("}, {"target_line_num": 134, "target_line_code": "headers::getFirst, responseHeaders::addFirst);"}, {"target_line_num": 138, "target_line_code": "private final CORSSupport _corsSupport;"}], "removed_line": [], "filename": "modules/apps/portal-remote/portal-remote-cors-impl/src/main/java/com/liferay/portal/remote/cors/internal/jaxrs/feature/CORSAnnotationDynamicFeature.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_348caa48b8b0d8e4404758f996d7da296cdf4ed0.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]