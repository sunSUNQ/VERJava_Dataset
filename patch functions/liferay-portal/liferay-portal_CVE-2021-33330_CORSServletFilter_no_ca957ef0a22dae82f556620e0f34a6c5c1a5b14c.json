[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 18, "target_line_code": "import com.liferay.oauth2.provider.scope.liferay.OAuth2ProviderScopeLiferayAccessControlContext;"}, {"target_line_num": 19, "target_line_code": "import com.liferay.portal.kernel.log.Log;"}, {"target_line_num": 20, "target_line_code": "import com.liferay.portal.kernel.log.LogFactoryUtil;"}, {"target_line_num": 21, "target_line_code": "import com.liferay.portal.kernel.servlet.BaseFilter;"}, {"target_line_num": 36, "target_line_code": "public class CORSServletFilter extends BaseFilter {"}, {"target_line_num": 39, "target_line_code": "public boolean isFilterEnabled("}, {"target_line_num": 40, "target_line_code": "HttpServletRequest httpServletRequest,"}, {"target_line_num": 41, "target_line_code": "HttpServletResponse httpServletResponse) {"}, {"target_line_num": 43, "target_line_code": "if (OAuth2ProviderScopeLiferayAccessControlContext."}, {"target_line_num": 44, "target_line_code": "isOAuth2AuthVerified() &&"}, {"target_line_num": 45, "target_line_code": "corsSupport.isCORSRequest(httpServletRequest::getHeader)) {"}, {"target_line_num": 47, "target_line_code": "return true;"}, {"target_line_num": 50, "target_line_code": "return false;"}], "removed_line": [{"source_line_num": 22, "source_line_code": "import java.io.IOException;"}, {"source_line_num": 26, "source_line_code": "import javax.servlet.Filter;"}, {"source_line_num": 28, "source_line_code": "import javax.servlet.FilterConfig;"}, {"source_line_num": 30, "source_line_code": "import javax.servlet.ServletRequest;"}, {"source_line_num": 31, "source_line_code": "import javax.servlet.ServletResponse;"}, {"source_line_num": 38, "source_line_code": "public class CORSServletFilter implements Filter {"}, {"source_line_num": 41, "source_line_code": "public void destroy() {"}, {"source_line_num": 44, "source_line_code": "@Override"}, {"source_line_num": 45, "source_line_code": "public final void doFilter("}, {"source_line_num": 46, "source_line_code": "ServletRequest servletRequest, ServletResponse servletResponse,"}, {"source_line_num": 47, "source_line_code": "FilterChain filterChain)"}, {"source_line_num": 48, "source_line_code": "throws IOException, ServletException {"}, {"source_line_num": 50, "source_line_code": "HttpServletRequest httpServletRequest ="}, {"source_line_num": 51, "source_line_code": "(HttpServletRequest)servletRequest;"}, {"source_line_num": 53, "source_line_code": "if (corsSupport.isCORSRequest(httpServletRequest::getHeader)) {"}, {"source_line_num": 54, "source_line_code": "try {"}, {"source_line_num": 55, "source_line_code": "processCORSRequest("}, {"source_line_num": 56, "source_line_code": "httpServletRequest, (HttpServletResponse)servletResponse,"}, {"source_line_num": 57, "source_line_code": "filterChain);"}, {"source_line_num": 59, "source_line_code": "catch (Exception exception) {"}, {"source_line_num": 60, "source_line_code": "throw new ServletException(exception);"}, {"source_line_num": 63, "source_line_code": "else {"}, {"source_line_num": 64, "source_line_code": "filterChain.doFilter(servletRequest, servletResponse);"}, {"source_line_num": 68, "source_line_code": "@Override"}, {"source_line_num": 69, "source_line_code": "public void init(FilterConfig filterConfig) throws ServletException {"}], "filename": "modules/apps/portal-remote/portal-remote-cors-impl/src/main/java/com/liferay/portal/remote/cors/internal/servlet/filter/CORSServletFilter.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_ca957ef0a22dae82f556620e0f34a6c5c1a5b14c.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]