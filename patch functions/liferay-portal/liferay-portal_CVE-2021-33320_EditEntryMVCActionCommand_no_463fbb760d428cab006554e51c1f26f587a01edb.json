[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 21, "target_line_code": "import com.liferay.portal.kernel.json.JSONFactoryUtil;"}, {"target_line_num": 22, "target_line_code": "import com.liferay.portal.kernel.json.JSONObject;"}, {"target_line_num": 23, "target_line_code": "import com.liferay.portal.kernel.language.LanguageUtil;"}, {"target_line_num": 24, "target_line_code": "import com.liferay.portal.kernel.log.Log;"}, {"target_line_num": 25, "target_line_code": "import com.liferay.portal.kernel.log.LogFactoryUtil;"}, {"target_line_num": 26, "target_line_code": "import com.liferay.portal.kernel.portlet.JSONPortletResponseUtil;"}, {"target_line_num": 31, "target_line_code": "import com.liferay.portal.kernel.theme.ThemeDisplay;"}, {"target_line_num": 33, "target_line_code": "import com.liferay.portal.kernel.util.WebKeys;"}, {"target_line_num": 59, "target_line_code": "JSONObject jsonObject = JSONFactoryUtil.createJSONObject();"}, {"target_line_num": 61, "target_line_code": "try {"}, {"target_line_num": 62, "target_line_code": "CaptchaUtil.check(actionRequest);"}, {"target_line_num": 64, "target_line_code": "String className = ParamUtil.getString(actionRequest, \"className\");"}, {"target_line_num": 65, "target_line_code": "long classPK = ParamUtil.getLong(actionRequest, \"classPK\");"}, {"target_line_num": 66, "target_line_code": "String reporterEmailAddress = ParamUtil.getString("}, {"target_line_num": 67, "target_line_code": "actionRequest, \"reporterEmailAddress\");"}, {"target_line_num": 68, "target_line_code": "long reportedUserId = ParamUtil.getLong("}, {"target_line_num": 69, "target_line_code": "actionRequest, \"reportedUserId\");"}, {"target_line_num": 70, "target_line_code": "String contentTitle = ParamUtil.getString("}, {"target_line_num": 71, "target_line_code": "actionRequest, \"contentTitle\");"}, {"target_line_num": 72, "target_line_code": "String contentURL = ParamUtil.getString("}, {"target_line_num": 73, "target_line_code": "actionRequest, \"contentURL\");"}, {"target_line_num": 74, "target_line_code": "String reason = ParamUtil.getString(actionRequest, \"reason\");"}, {"target_line_num": 76, "target_line_code": "ServiceContext serviceContext = ServiceContextFactory.getInstance("}, {"target_line_num": 77, "target_line_code": "\"com.liferay.portlet.flags.model.FlagsEntry\", actionRequest);"}, {"target_line_num": 79, "target_line_code": "_flagsEntryService.addEntry("}, {"target_line_num": 80, "target_line_code": "className, classPK, reporterEmailAddress, reportedUserId,"}, {"target_line_num": 81, "target_line_code": "contentTitle, contentURL, reason, serviceContext);"}, {"target_line_num": 83, "target_line_code": "catch (Exception exception) {"}, {"target_line_num": 84, "target_line_code": "_log.error(exception, exception);"}, {"target_line_num": 86, "target_line_code": "ThemeDisplay themeDisplay ="}, {"target_line_num": 87, "target_line_code": "(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);"}, {"target_line_num": 89, "target_line_code": "jsonObject.put("}, {"target_line_num": 90, "target_line_code": "\"error\","}, {"target_line_num": 91, "target_line_code": "LanguageUtil.get("}, {"target_line_num": 92, "target_line_code": "themeDisplay.getRequest(), \"an-unexpected-error-occurred\"));"}, {"target_line_num": 95, "target_line_code": "JSONPortletResponseUtil.writeJSON("}, {"target_line_num": 96, "target_line_code": "actionRequest, actionResponse, jsonObject);"}, {"target_line_num": 104, "target_line_code": "private static final Log _log = LogFactoryUtil.getLog("}, {"target_line_num": 105, "target_line_code": "EditEntryMVCActionCommand.class);"}], "removed_line": [{"source_line_num": 51, "source_line_code": "CaptchaUtil.check(actionRequest);"}, {"source_line_num": 53, "source_line_code": "String className = ParamUtil.getString(actionRequest, \"className\");"}, {"source_line_num": 54, "source_line_code": "long classPK = ParamUtil.getLong(actionRequest, \"classPK\");"}, {"source_line_num": 55, "source_line_code": "String reporterEmailAddress = ParamUtil.getString("}, {"source_line_num": 56, "source_line_code": "actionRequest, \"reporterEmailAddress\");"}, {"source_line_num": 57, "source_line_code": "long reportedUserId = ParamUtil.getLong("}, {"source_line_num": 58, "source_line_code": "actionRequest, \"reportedUserId\");"}, {"source_line_num": 59, "source_line_code": "String contentTitle = ParamUtil.getString("}, {"source_line_num": 60, "source_line_code": "actionRequest, \"contentTitle\");"}, {"source_line_num": 61, "source_line_code": "String contentURL = ParamUtil.getString(actionRequest, \"contentURL\");"}, {"source_line_num": 62, "source_line_code": "String reason = ParamUtil.getString(actionRequest, \"reason\");"}, {"source_line_num": 64, "source_line_code": "ServiceContext serviceContext = ServiceContextFactory.getInstance("}, {"source_line_num": 65, "source_line_code": "\"com.liferay.portlet.flags.model.FlagsEntry\", actionRequest);"}, {"source_line_num": 67, "source_line_code": "_flagsEntryService.addEntry("}, {"source_line_num": 68, "source_line_code": "className, classPK, reporterEmailAddress, reportedUserId,"}, {"source_line_num": 69, "source_line_code": "contentTitle, contentURL, reason, serviceContext);"}, {"source_line_num": 71, "source_line_code": "actionResponse.setRenderParameter(\"mvcPath\", \"/view.jsp\");"}], "filename": "modules/apps/flags/flags-web/src/main/java/com/liferay/flags/web/internal/portlet/action/EditEntryMVCActionCommand.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33320_463fbb760d428cab006554e51c1f26f587a01edb.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]