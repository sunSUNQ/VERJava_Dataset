[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 26, "target_line_code": "import com.liferay.portal.kernel.security.auth.PrincipalException;"}, {"target_line_num": 89, "target_line_code": "ThemeDisplay themeDisplay = (ThemeDisplay)actionRequest.getAttribute("}, {"target_line_num": 90, "target_line_code": "WebKeys.THEME_DISPLAY);"}, {"target_line_num": 92, "target_line_code": "if (themeDisplay == null) {"}, {"target_line_num": 93, "target_line_code": "throw new PrincipalException();"}, {"target_line_num": 96, "target_line_code": "final long userId = themeDisplay.getUserId();"}, {"target_line_num": 99, "target_line_code": "setupMFAChecker.removeExistingSetup(userId);"}, {"target_line_num": 102, "target_line_code": "_portal.getHttpServletRequest(actionRequest), userId)) {"}], "removed_line": [{"source_line_num": 88, "source_line_code": "long setupMFACheckerUserId = ParamUtil.getLong("}, {"source_line_num": 89, "source_line_code": "actionRequest, \"setupMFACheckerUserId\");"}, {"source_line_num": 92, "source_line_code": "setupMFAChecker.removeExistingSetup(setupMFACheckerUserId);"}, {"source_line_num": 95, "source_line_code": "_portal.getHttpServletRequest(actionRequest),"}, {"source_line_num": 96, "source_line_code": "setupMFACheckerUserId)) {"}, {"source_line_num": 105, "source_line_code": "ThemeDisplay themeDisplay ="}, {"source_line_num": 106, "source_line_code": "(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);"}], "filename": "modules/dxp/apps/multi-factor-authentication/multi-factor-authentication-web/src/main/java/com/liferay/multi/factor/authentication/web/internal/portlet/action/MFAUserAccountSetupMVCActionCommand.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-29041_1ce6b6aaa60dde8aeb71a433bf98367499dd16fd.diff", "patch_tag": "7.4.3.4-ga4", "source_tag": "7.4.2-ga3"}]