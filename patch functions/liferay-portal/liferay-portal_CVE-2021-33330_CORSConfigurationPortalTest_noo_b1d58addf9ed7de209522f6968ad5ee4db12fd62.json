[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 2, "target_line_code": "/**"}, {"target_line_num": 3, "target_line_code": "* Copyright (c) 2000-present Liferay, Inc. All rights reserved."}, {"target_line_num": 4, "target_line_code": "*"}, {"target_line_num": 5, "target_line_code": "* This library is free software; you can redistribute it and/or modify it under"}, {"target_line_num": 6, "target_line_code": "* the terms of the GNU Lesser General Public License as published by the Free"}, {"target_line_num": 7, "target_line_code": "* Software Foundation; either version 2.1 of the License, or (at your option)"}, {"target_line_num": 8, "target_line_code": "* any later version."}, {"target_line_num": 9, "target_line_code": "*"}, {"target_line_num": 10, "target_line_code": "* This library is distributed in the hope that it will be useful, but WITHOUT"}, {"target_line_num": 11, "target_line_code": "* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS"}, {"target_line_num": 12, "target_line_code": "* FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more"}, {"target_line_num": 13, "target_line_code": "* details."}, {"target_line_num": 14, "target_line_code": "*/"}, {"target_line_num": 16, "target_line_code": "package com.liferay.portal.remote.cors.client.test;"}, {"target_line_num": 18, "target_line_code": "import com.liferay.arquillian.extension.junit.bridge.junit.Arquillian;"}, {"target_line_num": 19, "target_line_code": "import com.liferay.portal.kernel.test.rule.AggregateTestRule;"}, {"target_line_num": 20, "target_line_code": "import com.liferay.portal.kernel.util.HashMapDictionary;"}, {"target_line_num": 21, "target_line_code": "import com.liferay.portal.remote.cors.configuration.PortalCORSConfiguration;"}, {"target_line_num": 22, "target_line_code": "import com.liferay.portal.test.rule.LiferayIntegrationTestRule;"}, {"target_line_num": 24, "target_line_code": "import java.util.Dictionary;"}, {"target_line_num": 26, "target_line_code": "import javax.ws.rs.HttpMethod;"}, {"target_line_num": 28, "target_line_code": "import org.junit.ClassRule;"}, {"target_line_num": 29, "target_line_code": "import org.junit.Rule;"}, {"target_line_num": 30, "target_line_code": "import org.junit.Test;"}, {"target_line_num": 31, "target_line_code": "import org.junit.runner.RunWith;"}, {"target_line_num": 33, "target_line_code": "/**"}, {"target_line_num": 34, "target_line_code": "* @author Marta Medio"}, {"target_line_num": 35, "target_line_code": "*/"}, {"target_line_num": 36, "target_line_code": "@RunWith(Arquillian.class)"}, {"target_line_num": 37, "target_line_code": "public class CORSConfigurationPortalTest extends BaseCORSClientTestCase {"}, {"target_line_num": 39, "target_line_code": "@ClassRule"}, {"target_line_num": 40, "target_line_code": "@Rule"}, {"target_line_num": 41, "target_line_code": "public static final AggregateTestRule aggregateTestRule ="}, {"target_line_num": 42, "target_line_code": "new LiferayIntegrationTestRule();"}, {"target_line_num": 44, "target_line_code": "@Test"}, {"target_line_num": 45, "target_line_code": "public void testNoCORSUsingBasic() throws Exception {"}, {"target_line_num": 46, "target_line_code": "assertJsonWSUrl(\"/user/get-current-user\", HttpMethod.OPTIONS, true);"}, {"target_line_num": 47, "target_line_code": "assertJsonWSUrl(\"/user/get-current-user\", HttpMethod.GET, false);"}, {"target_line_num": 49, "target_line_code": "Dictionary<String, Object> properties = new HashMapDictionary<>();"}, {"target_line_num": 51, "target_line_code": "properties.put(\"configuration.name\", \"test-cors\");"}, {"target_line_num": 53, "target_line_code": "properties.put(\"filter.mapping.url.pattern\", \"/api/jsonws/*\");"}, {"target_line_num": 55, "target_line_code": "createFactoryConfiguration("}, {"target_line_num": 56, "target_line_code": "PortalCORSConfiguration.class.getName(), properties);"}, {"target_line_num": 58, "target_line_code": "assertJsonWSUrl(\"/user/get-current-user\", HttpMethod.OPTIONS, true);"}, {"target_line_num": 59, "target_line_code": "assertJsonWSUrl(\"/user/get-current-user\", HttpMethod.GET, false);"}], "removed_line": [], "filename": "modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/CORSConfigurationPortalTest.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_b1d58addf9ed7de209522f6968ad5ee4db12fd62.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]