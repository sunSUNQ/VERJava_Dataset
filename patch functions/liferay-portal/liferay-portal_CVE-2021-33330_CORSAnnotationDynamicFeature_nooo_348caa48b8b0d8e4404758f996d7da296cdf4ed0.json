[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 69, "target_line_code": "context.register(new CORSContainerRequestFilter(corsSupport));"}], "removed_line": [{"source_line_num": 65, "source_line_code": "context.register(buildCORSResponseFilter(corsSupport));"}, {"source_line_num": 69, "source_line_code": "protected ContainerResponseFilter buildCORSResponseFilter("}, {"source_line_num": 70, "source_line_code": "CORSSupport corsSupport) {"}, {"source_line_num": 72, "source_line_code": "return (containerRequestContext, containerResponseContext) -> {"}, {"source_line_num": 73, "source_line_code": "MultivaluedMap<String, String> headers ="}, {"source_line_num": 74, "source_line_code": "containerRequestContext.getHeaders();"}, {"source_line_num": 76, "source_line_code": "if (corsSupport.isCORSRequest(headers::getFirst) &&"}, {"source_line_num": 77, "source_line_code": "corsSupport.isValidCORSRequest("}, {"source_line_num": 78, "source_line_code": "containerRequestContext.getMethod(), headers::getFirst)) {"}, {"source_line_num": 80, "source_line_code": "MultivaluedMap<String, Object> responseHeaders ="}, {"source_line_num": 81, "source_line_code": "containerResponseContext.getHeaders();"}, {"source_line_num": 83, "source_line_code": "corsSupport.writeResponseHeaders("}, {"source_line_num": 84, "source_line_code": "headers::getFirst, responseHeaders::addFirst);"}, {"source_line_num": 86, "source_line_code": "};"}], "filename": "modules/apps/portal-remote/portal-remote-cors-impl/src/main/java/com/liferay/portal/remote/cors/internal/jaxrs/feature/CORSAnnotationDynamicFeature.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_348caa48b8b0d8e4404758f996d7da296cdf4ed0.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]