[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 2, "target_line_code": "/**"}, {"target_line_num": 3, "target_line_code": "* Copyright (c) 2000-present Liferay, Inc. All rights reserved."}, {"target_line_num": 4, "target_line_code": "*"}, {"target_line_num": 5, "target_line_code": "* This library is free software; you can redistribute it and/or modify it under"}, {"target_line_num": 6, "target_line_code": "* the terms of the GNU Lesser General Public License as published by the Free"}, {"target_line_num": 7, "target_line_code": "* Software Foundation; either version 2.1 of the License, or (at your option)"}, {"target_line_num": 8, "target_line_code": "* any later version."}, {"target_line_num": 9, "target_line_code": "*"}, {"target_line_num": 10, "target_line_code": "* This library is distributed in the hope that it will be useful, but WITHOUT"}, {"target_line_num": 11, "target_line_code": "* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS"}, {"target_line_num": 12, "target_line_code": "* FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more"}, {"target_line_num": 13, "target_line_code": "* details."}, {"target_line_num": 14, "target_line_code": "*/"}, {"target_line_num": 16, "target_line_code": "package com.liferay.flags.web.internal.portlet.action;"}, {"target_line_num": 18, "target_line_code": "import com.liferay.captcha.util.CaptchaUtil;"}, {"target_line_num": 19, "target_line_code": "import com.liferay.flags.web.internal.constants.FlagsPortletKeys;"}, {"target_line_num": 20, "target_line_code": "import com.liferay.portal.kernel.portlet.bridges.mvc.MVCResourceCommand;"}, {"target_line_num": 22, "target_line_code": "import java.io.IOException;"}, {"target_line_num": 24, "target_line_code": "import javax.portlet.PortletException;"}, {"target_line_num": 25, "target_line_code": "import javax.portlet.ResourceRequest;"}, {"target_line_num": 26, "target_line_code": "import javax.portlet.ResourceResponse;"}, {"target_line_num": 28, "target_line_code": "import org.osgi.service.component.annotations.Component;"}, {"target_line_num": 30, "target_line_code": "/**"}, {"target_line_num": 31, "target_line_code": "* @author Alejandro Tard\u00edn"}, {"target_line_num": 32, "target_line_code": "*/"}, {"target_line_num": 33, "target_line_code": "@Component("}, {"target_line_num": 34, "target_line_code": "immediate = true,"}, {"target_line_num": 35, "target_line_code": "property = {"}, {"target_line_num": 36, "target_line_code": "\"javax.portlet.name=\" + FlagsPortletKeys.FLAGS,"}, {"target_line_num": 37, "target_line_code": "\"mvc.command.name=/flags/captcha_image\""}, {"target_line_num": 38, "target_line_code": "},"}, {"target_line_num": 39, "target_line_code": "service = MVCResourceCommand.class"}, {"target_line_num": 40, "target_line_code": ")"}, {"target_line_num": 41, "target_line_code": "public class CaptchaMVCResourceCommand implements MVCResourceCommand {"}, {"target_line_num": 43, "target_line_code": "@Override"}, {"target_line_num": 44, "target_line_code": "public boolean serveResource("}, {"target_line_num": 45, "target_line_code": "ResourceRequest resourceRequest, ResourceResponse resourceResponse)"}, {"target_line_num": 46, "target_line_code": "throws PortletException {"}, {"target_line_num": 48, "target_line_code": "try {"}, {"target_line_num": 49, "target_line_code": "CaptchaUtil.serveImage(resourceRequest, resourceResponse);"}, {"target_line_num": 51, "target_line_code": "return false;"}, {"target_line_num": 53, "target_line_code": "catch (IOException ioException) {"}, {"target_line_num": 54, "target_line_code": "throw new PortletException(ioException);"}], "removed_line": [], "filename": "modules/apps/flags/flags-web/src/main/java/com/liferay/flags/web/internal/portlet/action/CaptchaMVCResourceCommand.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33320_0b0d90c9a20ca6f4891d6bce87c83df99023b196.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]