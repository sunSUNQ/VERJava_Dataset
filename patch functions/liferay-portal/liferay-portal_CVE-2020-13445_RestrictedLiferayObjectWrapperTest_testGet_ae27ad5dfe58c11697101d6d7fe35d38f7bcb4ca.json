[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 304, "target_line_code": "public class TestLiferayMethodObject {"}, {"target_line_num": 306, "target_line_code": "public String generate(String postfix) {"}, {"target_line_num": 307, "target_line_code": "return _name + StringPool.DASH + postfix;"}, {"target_line_num": 310, "target_line_code": "public String getName() {"}, {"target_line_num": 311, "target_line_code": "return _name;"}, {"target_line_num": 314, "target_line_code": "public void setName(String name) {"}, {"target_line_num": 315, "target_line_code": "_name = name;"}, {"target_line_num": 318, "target_line_code": "@Override"}, {"target_line_num": 319, "target_line_code": "public String toString() {"}, {"target_line_num": 320, "target_line_code": "return _name;"}, {"target_line_num": 323, "target_line_code": "private TestLiferayMethodObject(String name) {"}, {"target_line_num": 324, "target_line_code": "_name = name;"}, {"target_line_num": 327, "target_line_code": "private String _name;"}, {"target_line_num": 331, "target_line_code": "private boolean _isRestricted("}, {"target_line_num": 332, "target_line_code": "RestrictedLiferayObjectWrapper restrictedLiferayObjectWrapper,"}, {"target_line_num": 333, "target_line_code": "Class<?> targetClass) {"}, {"target_line_num": 335, "target_line_code": "return ReflectionTestUtil.invoke("}, {"target_line_num": 336, "target_line_code": "restrictedLiferayObjectWrapper, \"_isRestricted\","}, {"target_line_num": 337, "target_line_code": "new Class<?>[] {Class.class}, targetClass);"}], "removed_line": [{"source_line_num": 249, "source_line_code": "private void _testCheckClassIsRestricted("}, {"source_line_num": 250, "source_line_code": "RestrictedLiferayObjectWrapper restrictedLiferayObjectWrapper,"}, {"source_line_num": 251, "source_line_code": "Class<?> targetClass, String exceptionMessage) {"}, {"source_line_num": 253, "source_line_code": "try {"}, {"source_line_num": 254, "source_line_code": "ReflectionTestUtil.invoke("}, {"source_line_num": 255, "source_line_code": "restrictedLiferayObjectWrapper, \"_checkClassIsRestricted\","}, {"source_line_num": 256, "source_line_code": "new Class<?>[] {Class.class}, targetClass);"}, {"source_line_num": 258, "source_line_code": "Assert.assertNull("}, {"source_line_num": 259, "source_line_code": "\"Should throw TemplateModelException\", exceptionMessage);"}, {"source_line_num": 261, "source_line_code": "catch (Exception exception) {"}, {"source_line_num": 262, "source_line_code": "Assert.assertSame("}, {"source_line_num": 263, "source_line_code": "TemplateModelException.class, exception.getClass());"}, {"source_line_num": 265, "source_line_code": "TemplateModelException templateModelException ="}, {"source_line_num": 266, "source_line_code": "(TemplateModelException)exception;"}, {"source_line_num": 268, "source_line_code": "Assert.assertEquals("}, {"source_line_num": 269, "source_line_code": "exceptionMessage, templateModelException.getMessage());"}], "filename": "modules/apps/portal-template/portal-template-freemarker/src/test/java/com/liferay/portal/template/freemarker/internal/RestrictedLiferayObjectWrapperTest.java", "patch_func": "testGet", "diff_file": "liferay-portal_CVE-2020-13445_ae27ad5dfe58c11697101d6d7fe35d38f7bcb4ca.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]