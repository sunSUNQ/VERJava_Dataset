[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 20, "target_line_code": "import com.liferay.portal.kernel.util.Base64;"}, {"target_line_num": 35, "target_line_code": "public AllowRestrictedHeadersCallable("}, {"target_line_num": 36, "target_line_code": "String url, String origin, String method, boolean authenticate) {"}, {"target_line_num": 40, "target_line_code": "_method = method;"}, {"target_line_num": 41, "target_line_code": "_authenticate = authenticate;"}, {"target_line_num": 54, "target_line_code": "_ACCESS_CONTROL_REQUEST_METHOD, _method);"}, {"target_line_num": 56, "target_line_code": "if (_authenticate) {"}, {"target_line_num": 57, "target_line_code": "String encodedUserNameAndPassword = Base64.encode("}, {"target_line_num": 58, "target_line_code": "\"test@liferay.com:test\".getBytes());"}, {"target_line_num": 60, "target_line_code": "httpURLConnection.setRequestProperty("}, {"target_line_num": 61, "target_line_code": "\"Authorization\", \"Basic \" + encodedUserNameAndPassword);"}, {"target_line_num": 87, "target_line_code": "private final boolean _authenticate;"}, {"target_line_num": 88, "target_line_code": "private final String _method;"}], "removed_line": [{"source_line_num": 34, "source_line_code": "public AllowRestrictedHeadersCallable(String url, String origin) {"}, {"source_line_num": 49, "source_line_code": "_ACCESS_CONTROL_REQUEST_METHOD, \"GET\");"}], "filename": "modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/AllowRestrictedHeadersCallable.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_bcdf4fa432d7c559e380e922e869d3569564330a.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]