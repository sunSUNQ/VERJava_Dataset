[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 64, "target_line_code": "public void testApplicationNoCorsWithoutOAuth2() throws Exception {"}, {"target_line_num": 66, "target_line_code": "assertJaxRSUrl(\"/cors/cors-app\", HttpMethod.GET, false);"}], "removed_line": [{"source_line_num": 62, "source_line_code": "properties = new HashMapDictionary<>();"}, {"source_line_num": 64, "source_line_code": "properties.put(\"osgi.jaxrs.name\", \"test-cors-url\");"}, {"source_line_num": 66, "source_line_code": "registerJaxRsApplication("}, {"source_line_num": 67, "source_line_code": "new CORSTestApplication(), \"test-cors-url\", properties);"}, {"source_line_num": 69, "source_line_code": "properties = new HashMapDictionary<>();"}, {"source_line_num": 71, "source_line_code": "properties.put(\"filter.mapping.url.patterns\", \"/cors-app\");"}, {"source_line_num": 72, "source_line_code": "properties.put("}, {"source_line_num": 73, "source_line_code": "\"servlet.context.helper.select.filter\","}, {"source_line_num": 74, "source_line_code": "\"(osgi.jaxrs.name=test-cors-url)\");"}, {"source_line_num": 76, "source_line_code": "createFactoryConfiguration("}, {"source_line_num": 77, "source_line_code": "WebContextCORSConfiguration.class.getName(), properties);"}, {"source_line_num": 79, "source_line_code": "registerJaxRsApplication("}, {"source_line_num": 80, "source_line_code": "new CORSTestApplication(), \"no-cors\", new HashMapDictionary<>());"}, {"source_line_num": 82, "source_line_code": "properties = new HashMapDictionary<>();"}, {"source_line_num": 84, "source_line_code": "properties.put(\"osgi.jaxrs.name\", \"test-cors-wrong-url\");"}, {"source_line_num": 86, "source_line_code": "registerJaxRsApplication("}, {"source_line_num": 87, "source_line_code": "new CORSTestApplication(), \"test-cors-wrong-url\", properties);"}, {"source_line_num": 89, "source_line_code": "properties = new HashMapDictionary<>();"}, {"source_line_num": 91, "source_line_code": "properties.put(\"filter.mapping.url.patterns\", \"/wrong\");"}, {"source_line_num": 92, "source_line_code": "properties.put("}, {"source_line_num": 93, "source_line_code": "\"servlet.context.helper.select.filter\","}, {"source_line_num": 94, "source_line_code": "\"(osgi.jaxrs.name=test-cors-wrong-url)\");"}, {"source_line_num": 96, "source_line_code": "createFactoryConfiguration("}, {"source_line_num": 97, "source_line_code": "WebContextCORSConfiguration.class.getName(), properties);"}, {"source_line_num": 100, "source_line_code": "@Test"}, {"source_line_num": 101, "source_line_code": "public void testCORSApplication() throws Exception {"}, {"source_line_num": 102, "source_line_code": "assertJaxRSUrl(\"/cors/cors-app\", HttpMethod.GET, true);"}, {"source_line_num": 103, "source_line_code": "assertJaxRSUrl(\"/no-cors/cors-app\", HttpMethod.GET, false);"}, {"source_line_num": 104, "source_line_code": "assertJaxRSUrl(\"/test-cors-url/cors-app\", HttpMethod.GET, true);"}, {"source_line_num": 105, "source_line_code": "assertJaxRSUrl(\"/test-cors-wrong-url/cors-app\", HttpMethod.GET, false);"}, {"source_line_num": 109, "source_line_code": "public void testCORSPreflightApplication() throws Exception {"}, {"source_line_num": 111, "source_line_code": "assertJaxRSUrl(\"/no-cors/cors-app\", HttpMethod.OPTIONS, false);"}, {"source_line_num": 112, "source_line_code": "assertJaxRSUrl(\"/test-cors-url/cors-app\", HttpMethod.OPTIONS, true);"}, {"source_line_num": 113, "source_line_code": "assertJaxRSUrl("}, {"source_line_num": 114, "source_line_code": "\"/test-cors-wrong-url/cors-app\", HttpMethod.OPTIONS, false);"}], "filename": "modules/apps/portal-remote/portal-remote-cors-test/src/testIntegration/java/com/liferay/portal/remote/cors/client/test/CORSConfigurationClientTest.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33330_b1d58addf9ed7de209522f6968ad5ee4db12fd62.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]