[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 25, "target_line_code": "import com.liferay.portal.kernel.util.StringBundler;"}, {"target_line_num": 627, "target_line_code": "Assert.assertTrue(_portalImpl.isValidResourceId(\"%25252525252525252f\"));"}, {"target_line_num": 629, "target_line_code": "StringBundler sb = new StringBundler();"}, {"target_line_num": 631, "target_line_code": "sb.append(\"%\");"}, {"target_line_num": 633, "target_line_code": "for (int i = 0; i < 100000; i++) {"}, {"target_line_num": 634, "target_line_code": "sb.append(\"25\");"}, {"target_line_num": 637, "target_line_code": "sb.append(\"2f\");"}, {"target_line_num": 639, "target_line_code": "try {"}, {"target_line_num": 640, "target_line_code": "Assert.assertFalse(_portalImpl.isValidResourceId(sb.toString()));"}, {"target_line_num": 642, "target_line_code": "catch (OutOfMemoryError oome) {"}, {"target_line_num": 643, "target_line_code": "Assert.fail();"}], "removed_line": [], "filename": "portal-impl/test/unit/com/liferay/portal/util/PortalImplUnitTest.java", "patch_func": "testIsValidResourceId", "diff_file": "liferay-portal_CVE-2020-15840_d7dc329b4e12dd1c1566a7c9da8e48a1ed05ee07.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]