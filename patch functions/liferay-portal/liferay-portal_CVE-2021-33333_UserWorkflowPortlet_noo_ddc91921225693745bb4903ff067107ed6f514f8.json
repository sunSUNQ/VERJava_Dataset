[{"cve_id": "liferay-portal", "added_line": [{"target_line_num": 117, "target_line_code": "protected void checkWorkflowInstanceViewPermission("}, {"target_line_num": 118, "target_line_code": "RenderRequest renderRequest)"}, {"target_line_num": 119, "target_line_code": "throws PortalException {"}, {"target_line_num": 121, "target_line_code": "PermissionChecker permissionChecker ="}, {"target_line_num": 122, "target_line_code": "PermissionThreadLocal.getPermissionChecker();"}, {"target_line_num": 124, "target_line_code": "long workflowInstanceId = ParamUtil.getLong("}, {"target_line_num": 125, "target_line_code": "renderRequest, \"workflowInstanceId\");"}, {"target_line_num": 127, "target_line_code": "if (workflowInstanceId != 0) {"}, {"target_line_num": 128, "target_line_code": "WorkflowInstance workflowInstance ="}, {"target_line_num": 129, "target_line_code": "WorkflowInstanceManagerUtil.getWorkflowInstance("}, {"target_line_num": 130, "target_line_code": "permissionChecker.getCompanyId(),"}, {"target_line_num": 131, "target_line_code": "permissionChecker.getUserId(), workflowInstanceId);"}, {"target_line_num": 133, "target_line_code": "if (workflowInstance == null) {"}, {"target_line_num": 134, "target_line_code": "throw new PrincipalException.MustHavePermission("}, {"target_line_num": 135, "target_line_code": "permissionChecker, WorkflowInstance.class.getName(),"}, {"target_line_num": 136, "target_line_code": "workflowInstanceId, ActionKeys.VIEW);"}, {"target_line_num": 141, "target_line_code": "@Override"}, {"target_line_num": 142, "target_line_code": "protected void doDispatch("}, {"target_line_num": 143, "target_line_code": "RenderRequest renderRequest, RenderResponse renderResponse)"}, {"target_line_num": 144, "target_line_code": "throws IOException, PortletException {"}, {"target_line_num": 146, "target_line_code": "if (SessionErrors.contains("}, {"target_line_num": 147, "target_line_code": "renderRequest, PrincipalException.getNestedClasses()) ||"}, {"target_line_num": 148, "target_line_code": "SessionErrors.contains("}, {"target_line_num": 149, "target_line_code": "renderRequest, WorkflowException.class.getName())) {"}, {"target_line_num": 151, "target_line_code": "include(\"/instance/error.jsp\", renderRequest, renderResponse);"}, {"target_line_num": 153, "target_line_code": "else {"}, {"target_line_num": 154, "target_line_code": "super.doDispatch(renderRequest, renderResponse);"}], "removed_line": [], "filename": "modules/apps/portal-workflow/portal-workflow-web/src/main/java/com/liferay/portal/workflow/web/internal/portlet/UserWorkflowPortlet.java", "patch_func": "no", "diff_file": "liferay-portal_CVE-2021-33333_ddc91921225693745bb4903ff067107ed6f514f8.diff", "patch_tag": "7.4.2-ga3", "source_tag": "7.4.1-ga2"}]