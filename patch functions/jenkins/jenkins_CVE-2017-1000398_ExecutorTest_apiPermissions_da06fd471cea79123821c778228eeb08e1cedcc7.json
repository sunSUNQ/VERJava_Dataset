[{"cve_id": "jenkins", "added_line": [{"target_line_num": 125, "target_line_code": "public void apiPermissions() throws Exception {"}, {"target_line_num": 126, "target_line_code": "DumbSlave slave = new DumbSlave(\"slave\", j.jenkins.getRootDir().getAbsolutePath(), j.createComputerLauncher(null));"}, {"target_line_num": 127, "target_line_code": "slave.setNumExecutors(2);"}, {"target_line_num": 128, "target_line_code": "j.jenkins.addNode(slave);"}, {"target_line_num": 129, "target_line_code": "FreeStyleProject publicProject = j.createFreeStyleProject(\"public-project\");"}, {"target_line_num": 130, "target_line_code": "publicProject.setAssignedNode(slave);"}, {"target_line_num": 131, "target_line_code": "startBlockingBuild(publicProject);"}, {"target_line_num": 132, "target_line_code": "FreeStyleProject secretProject = j.createFreeStyleProject(\"secret-project\");"}, {"target_line_num": 133, "target_line_code": "secretProject.setAssignedNode(slave);"}, {"target_line_num": 134, "target_line_code": "startBlockingBuild(secretProject);"}, {"target_line_num": 135, "target_line_code": "j.jenkins.setSecurityRealm(j.createDummySecurityRealm());"}, {"target_line_num": 136, "target_line_code": "j.jenkins.setAuthorizationStrategy(new MockAuthorizationStrategy()."}, {"target_line_num": 137, "target_line_code": "grant(Jenkins.READ).everywhere().toEveryone()."}, {"target_line_num": 138, "target_line_code": "grant(Item.READ).onItems(publicProject).toEveryone()."}, {"target_line_num": 139, "target_line_code": "grant(Item.READ).onItems(secretProject).to(\"has-security-clearance\"));"}, {"target_line_num": 140, "target_line_code": "String api = j.createWebClient().login(\"has-security-clearance\").goTo(slave.toComputer().getUrl() + \"api/json?pretty&depth=1\", null).getWebResponse().getContentAsString();"}, {"target_line_num": 141, "target_line_code": "System.out.println(api);"}, {"target_line_num": 142, "target_line_code": "assertThat(api, allOf(containsString(\"public-project\"), containsString(\"secret-project\")));"}, {"target_line_num": 143, "target_line_code": "api = j.createWebClient().login(\"regular-joe\").goTo(slave.toComputer().getUrl() + \"api/json?pretty&depth=1\", null).getWebResponse().getContentAsString();"}, {"target_line_num": 144, "target_line_code": "System.out.println(api);"}, {"target_line_num": 145, "target_line_code": "assertThat(api, allOf(containsString(\"public-project\"), not(containsString(\"secret-project\"))));"}], "removed_line": [], "filename": "test/src/test/java/hudson/model/ExecutorTest.java", "patch_func": "apiPermissions", "diff_file": "jenkins_CVE-2017-1000398_da06fd471cea79123821c778228eeb08e1cedcc7.diff", "patch_tag": "jenkins-2.100", "source_tag": "jenkins-2.99"}]