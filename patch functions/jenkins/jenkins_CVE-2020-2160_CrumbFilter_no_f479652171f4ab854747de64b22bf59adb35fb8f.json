[{"cve_id": "jenkins", "added_line": [{"target_line_num": 67, "target_line_code": "private static class Security1774ServletRequest extends HttpServletRequestWrapper {"}, {"target_line_num": 68, "target_line_code": "public Security1774ServletRequest(HttpServletRequest request) {"}, {"target_line_num": 69, "target_line_code": "super(request);"}, {"target_line_num": 72, "target_line_code": "@Override"}, {"target_line_num": 73, "target_line_code": "public String getPathInfo() {"}, {"target_line_num": 75, "target_line_code": "return canonicalPath(getRequestURI().substring(getContextPath().length()));"}, {"target_line_num": 80, "target_line_code": "private static String canonicalPath(String path) {"}, {"target_line_num": 81, "target_line_code": "List<String> r = new ArrayList<String>(Arrays.asList(path.split(\"/+\")));"}, {"target_line_num": 82, "target_line_code": "for (int i=0; i<r.size(); ) {"}, {"target_line_num": 83, "target_line_code": "if (r.get(i).length()==0 || r.get(i).equals(\".\")) {"}, {"target_line_num": 85, "target_line_code": "r.remove(i);"}, {"target_line_num": 86, "target_line_code": "} else"}, {"target_line_num": 87, "target_line_code": "if (r.get(i).equals(\"..\")) {"}, {"target_line_num": 89, "target_line_code": "r.remove(i);"}, {"target_line_num": 90, "target_line_code": "if (i>0) {"}, {"target_line_num": 91, "target_line_code": "r.remove(i-1);"}, {"target_line_num": 92, "target_line_code": "i--;"}, {"target_line_num": 94, "target_line_code": "} else {"}, {"target_line_num": 95, "target_line_code": "i++;"}, {"target_line_num": 99, "target_line_code": "StringBuilder buf = new StringBuilder();"}, {"target_line_num": 100, "target_line_code": "if (path.startsWith(\"/\"))"}, {"target_line_num": 101, "target_line_code": "buf.append('/');"}, {"target_line_num": 102, "target_line_code": "boolean first = true;"}, {"target_line_num": 103, "target_line_code": "for (String token : r) {"}, {"target_line_num": 104, "target_line_code": "if (!first)     buf.append('/');"}, {"target_line_num": 105, "target_line_code": "else            first = false;"}, {"target_line_num": 106, "target_line_code": "buf.append(token);"}, {"target_line_num": 109, "target_line_code": "if (path.endsWith(\"/\") && (buf.length()==0 || buf.charAt(buf.length()-1)!='/'))"}, {"target_line_num": 110, "target_line_code": "buf.append('/');"}, {"target_line_num": 111, "target_line_code": "return buf.toString();"}], "removed_line": [], "filename": "core/src/main/java/hudson/security/csrf/CrumbFilter.java", "patch_func": "no", "diff_file": "jenkins_CVE-2020-2160_f479652171f4ab854747de64b22bf59adb35fb8f.diff", "patch_tag": "jenkins-2.204.6", "source_tag": "jenkins-2.204.5"}]