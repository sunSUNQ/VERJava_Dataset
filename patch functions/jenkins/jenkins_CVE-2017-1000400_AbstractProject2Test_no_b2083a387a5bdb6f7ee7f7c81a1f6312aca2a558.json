[{"cve_id": "jenkins", "added_line": [{"target_line_num": 2, "target_line_code": "/*"}, {"target_line_num": 3, "target_line_code": "* The MIT License"}, {"target_line_num": 4, "target_line_code": "*"}, {"target_line_num": 5, "target_line_code": "* Copyright 2017 CloudBees, Inc."}, {"target_line_num": 6, "target_line_code": "*"}, {"target_line_num": 7, "target_line_code": "* Permission is hereby granted, free of charge, to any person obtaining a copy"}, {"target_line_num": 8, "target_line_code": "* of this software and associated documentation files (the \"Software\"), to deal"}, {"target_line_num": 9, "target_line_code": "* in the Software without restriction, including without limitation the rights"}, {"target_line_num": 10, "target_line_code": "* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell"}, {"target_line_num": 11, "target_line_code": "* copies of the Software, and to permit persons to whom the Software is"}, {"target_line_num": 12, "target_line_code": "* furnished to do so, subject to the following conditions:"}, {"target_line_num": 13, "target_line_code": "*"}, {"target_line_num": 14, "target_line_code": "* The above copyright notice and this permission notice shall be included in"}, {"target_line_num": 15, "target_line_code": "* all copies or substantial portions of the Software."}, {"target_line_num": 16, "target_line_code": "*"}, {"target_line_num": 17, "target_line_code": "* THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR"}, {"target_line_num": 18, "target_line_code": "* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,"}, {"target_line_num": 19, "target_line_code": "* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE"}, {"target_line_num": 20, "target_line_code": "* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER"}, {"target_line_num": 21, "target_line_code": "* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,"}, {"target_line_num": 22, "target_line_code": "* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN"}, {"target_line_num": 23, "target_line_code": "* THE SOFTWARE."}, {"target_line_num": 24, "target_line_code": "*/"}, {"target_line_num": 26, "target_line_code": "package hudson.model;"}, {"target_line_num": 28, "target_line_code": "import hudson.tasks.BuildTrigger;"}, {"target_line_num": 29, "target_line_code": "import java.util.Collections;"}, {"target_line_num": 30, "target_line_code": "import jenkins.model.Jenkins;"}, {"target_line_num": 31, "target_line_code": "import static org.hamcrest.Matchers.*;"}, {"target_line_num": 32, "target_line_code": "import org.junit.Test;"}, {"target_line_num": 33, "target_line_code": "import static org.junit.Assert.*;"}, {"target_line_num": 34, "target_line_code": "import org.junit.Rule;"}, {"target_line_num": 35, "target_line_code": "import org.jvnet.hudson.test.Issue;"}, {"target_line_num": 36, "target_line_code": "import org.jvnet.hudson.test.JenkinsRule;"}, {"target_line_num": 37, "target_line_code": "import org.jvnet.hudson.test.MockAuthorizationStrategy;"}, {"target_line_num": 40, "target_line_code": "public class AbstractProject2Test {"}, {"target_line_num": 42, "target_line_code": "@Rule"}, {"target_line_num": 43, "target_line_code": "public JenkinsRule r = new JenkinsRule();"}, {"target_line_num": 45, "target_line_code": "@Issue(\"SECURITY-617\")"}, {"target_line_num": 46, "target_line_code": "@Test"}, {"target_line_num": 47, "target_line_code": "public void upstreamDownstreamExportApi() throws Exception {"}, {"target_line_num": 48, "target_line_code": "FreeStyleProject us = r.createFreeStyleProject(\"upstream-project\");"}, {"target_line_num": 49, "target_line_code": "FreeStyleProject ds = r.createFreeStyleProject(\"downstream-project\");"}, {"target_line_num": 50, "target_line_code": "us.getPublishersList().add(new BuildTrigger(Collections.singleton(ds), Result.SUCCESS));"}, {"target_line_num": 51, "target_line_code": "r.jenkins.rebuildDependencyGraph();"}, {"target_line_num": 52, "target_line_code": "assertEquals(Collections.singletonList(ds), us.getDownstreamProjects());"}, {"target_line_num": 53, "target_line_code": "assertEquals(Collections.singletonList(us), ds.getUpstreamProjects());"}, {"target_line_num": 54, "target_line_code": "r.jenkins.setSecurityRealm(r.createDummySecurityRealm());"}, {"target_line_num": 55, "target_line_code": "r.jenkins.setAuthorizationStrategy(new MockAuthorizationStrategy()."}, {"target_line_num": 56, "target_line_code": "grant(Jenkins.READ).everywhere().toEveryone()."}, {"target_line_num": 57, "target_line_code": "grant(Item.READ).everywhere().to(\"alice\")."}, {"target_line_num": 58, "target_line_code": "grant(Item.READ).onItems(us).to(\"bob\")."}, {"target_line_num": 59, "target_line_code": "grant(Item.READ).onItems(ds).to(\"charlie\"));"}, {"target_line_num": 60, "target_line_code": "String api = r.createWebClient().login(\"alice\").goTo(us.getUrl() + \"api/json?pretty\", null).getWebResponse().getContentAsString();"}, {"target_line_num": 61, "target_line_code": "System.out.println(api);"}, {"target_line_num": 62, "target_line_code": "assertThat(api, containsString(\"downstream-project\"));"}, {"target_line_num": 63, "target_line_code": "api = r.createWebClient().login(\"alice\").goTo(ds.getUrl() + \"api/json?pretty\", null).getWebResponse().getContentAsString();"}, {"target_line_num": 64, "target_line_code": "System.out.println(api);"}, {"target_line_num": 65, "target_line_code": "assertThat(api, containsString(\"upstream-project\"));"}, {"target_line_num": 66, "target_line_code": "api = r.createWebClient().login(\"bob\").goTo(us.getUrl() + \"api/json?pretty\", null).getWebResponse().getContentAsString();"}, {"target_line_num": 67, "target_line_code": "System.out.println(api);"}, {"target_line_num": 68, "target_line_code": "assertThat(api, not(containsString(\"downstream-project\")));"}, {"target_line_num": 69, "target_line_code": "api = r.createWebClient().login(\"charlie\").goTo(ds.getUrl() + \"api/json?pretty\", null).getWebResponse().getContentAsString();"}, {"target_line_num": 70, "target_line_code": "System.out.println(api);"}, {"target_line_num": 71, "target_line_code": "assertThat(api, not(containsString(\"upstream-project\")));"}], "removed_line": [], "filename": "test/src/test/java/hudson/model/AbstractProject2Test.java", "patch_func": "no", "diff_file": "jenkins_CVE-2017-1000400_b2083a387a5bdb6f7ee7f7c81a1f6312aca2a558.diff", "patch_tag": "jenkins-2.100", "source_tag": "jenkins-2.99"}]