[{"cve_id": "spring-framework", "added_line": [{"target_line_num": 22, "target_line_code": "import java.io.UnsupportedEncodingException;"}, {"target_line_num": 23, "target_line_code": "import java.net.URLDecoder;"}, {"target_line_num": 37, "target_line_code": "import org.springframework.core.io.UrlResource;"}, {"target_line_num": 42, "target_line_code": "import org.springframework.util.ResourceUtils;"}, {"target_line_num": 169, "target_line_code": "path = processPath(path);"}, {"target_line_num": 176, "target_line_code": "if (path.contains(\"%\")) {"}, {"target_line_num": 177, "target_line_code": "try {"}, {"target_line_num": 179, "target_line_code": "if (isInvalidPath(URLDecoder.decode(path, \"UTF-8\"))) {"}, {"target_line_num": 180, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 181, "target_line_code": "logger.trace(\"Ignoring invalid resource path with escape sequences [\" + path + \"].\");"}, {"target_line_num": 183, "target_line_code": "return null;"}, {"target_line_num": 186, "target_line_code": "catch (UnsupportedEncodingException e) {"}, {"target_line_num": 189, "target_line_code": "catch (IllegalArgumentException ex) {"}, {"target_line_num": 200, "target_line_code": "if (isResourceUnderLocation(resource, location)) {"}, {"target_line_num": 201, "target_line_code": "if (logger.isDebugEnabled()) {"}, {"target_line_num": 202, "target_line_code": "logger.debug(\"Found matching resource: \" + resource);"}, {"target_line_num": 204, "target_line_code": "return resource;"}, {"target_line_num": 206, "target_line_code": "else {"}, {"target_line_num": 207, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 208, "target_line_code": "logger.trace(\"resource=\\\"\" + resource + \"\\\" was successfully resolved \" +"}, {"target_line_num": 209, "target_line_code": "\"but is not under the location=\\\"\" + location);"}, {"target_line_num": 211, "target_line_code": "return null;"}], "removed_line": [{"source_line_num": 180, "source_line_code": "if (logger.isDebugEnabled()) {"}, {"source_line_num": 181, "source_line_code": "logger.debug(\"Found matching resource: \" + resource);"}, {"source_line_num": 183, "source_line_code": "return resource;"}], "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java", "patch_func": "no", "diff_file": "spring-framework_CVE-2014-3625_9beae9ae4226c45cd428035dae81214439324676.diff", "patch_tag": "v4.0.8.RELEASE", "source_tag": "v4.0.7.RELEASE"}]