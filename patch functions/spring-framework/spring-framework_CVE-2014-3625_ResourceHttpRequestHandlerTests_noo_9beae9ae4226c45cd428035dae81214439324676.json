[{"cve_id": "spring-framework", "added_line": [{"target_line_num": 132, "target_line_code": "public void invalidPath() throws Exception {"}, {"target_line_num": 137, "target_line_code": "Resource location = new ClassPathResource(\"test/\", getClass());"}, {"target_line_num": 138, "target_line_code": "this.handler.setLocations(Arrays.asList(location));"}, {"target_line_num": 140, "target_line_code": "testInvalidPath(location, \"../testsecret/secret.txt\", request, response);"}, {"target_line_num": 141, "target_line_code": "testInvalidPath(location, \"test/../../testsecret/secret.txt\", request, response);"}, {"target_line_num": 142, "target_line_code": "testInvalidPath(location, \":/../../testsecret/secret.txt\", request, response);"}, {"target_line_num": 144, "target_line_code": "location = new UrlResource(getClass().getResource(\"./test/\"));"}, {"target_line_num": 138, "target_line_code": "this.handler.setLocations(Arrays.asList(location));"}, {"target_line_num": 146, "target_line_code": "Resource secretResource = new UrlResource(getClass().getResource(\"testsecret/secret.txt\"));"}, {"target_line_num": 147, "target_line_code": "String secretPath = secretResource.getURL().getPath();"}, {"target_line_num": 149, "target_line_code": "testInvalidPath(location, \"file:\" + secretPath, request, response);"}, {"target_line_num": 150, "target_line_code": "testInvalidPath(location, \"/file:\" + secretPath, request, response);"}, {"target_line_num": 151, "target_line_code": "testInvalidPath(location, \"url:\" + secretPath, request, response);"}, {"target_line_num": 152, "target_line_code": "testInvalidPath(location, \"/url:\" + secretPath, request, response);"}, {"target_line_num": 153, "target_line_code": "testInvalidPath(location, \"/\" + secretPath, request, response);"}, {"target_line_num": 155, "target_line_code": "testInvalidPath(location, \"/%2E%2E/testsecret/secret.txt\", request, response);"}, {"target_line_num": 156, "target_line_code": "testInvalidPath(location, \"/%2e%2e/testsecret/secret.txt\", request, response);"}, {"target_line_num": 157, "target_line_code": "testInvalidPath(location, \" \" + secretPath, request, response);"}, {"target_line_num": 158, "target_line_code": "testInvalidPath(location, \"/  \" + secretPath, request, response);"}, {"target_line_num": 151, "target_line_code": "testInvalidPath(location, \"url:\" + secretPath, request, response);"}, {"target_line_num": 162, "target_line_code": "@Test"}, {"target_line_num": 163, "target_line_code": "public void ignoreInvalidEscapeSequence() throws Exception {"}, {"target_line_num": 164, "target_line_code": "MockHttpServletRequest request = new MockHttpServletRequest();"}, {"target_line_num": 165, "target_line_code": "request.setMethod(\"GET\");"}, {"target_line_num": 166, "target_line_code": "MockHttpServletResponse response = new MockHttpServletResponse();"}, {"target_line_num": 167, "target_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"/%foo%/bar.txt\");"}, {"target_line_num": 169, "target_line_code": "this.handler.handleRequest(request, response);"}, {"target_line_num": 173, "target_line_code": "@Test"}, {"target_line_num": 174, "target_line_code": "public void processPath() throws Exception {"}, {"target_line_num": 175, "target_line_code": "assertSame(\"/foo/bar\", this.handler.processPath(\"/foo/bar\"));"}, {"target_line_num": 176, "target_line_code": "assertSame(\"foo/bar\", this.handler.processPath(\"foo/bar\"));"}, {"target_line_num": 179, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath(\"  /foo/bar\"));"}, {"target_line_num": 180, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 1 + \"/foo/bar\"));"}, {"target_line_num": 181, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 31 + \"/foo/bar\"));"}, {"target_line_num": 182, "target_line_code": "assertEquals(\"foo/bar\", this.handler.processPath(\"  foo/bar\"));"}, {"target_line_num": 183, "target_line_code": "assertEquals(\"foo/bar\", this.handler.processPath((char) 31 + \"foo/bar\"));"}, {"target_line_num": 186, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 127 + \"/foo/bar\"));"}, {"target_line_num": 186, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 127 + \"/foo/bar\"));"}, {"target_line_num": 190, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath(\"  /  foo/bar\"));"}, {"target_line_num": 191, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath(\"  /  /  foo/bar\"));"}, {"target_line_num": 196, "target_line_code": "assertEquals(\"\", this.handler.processPath(\"   \"));"}, {"target_line_num": 197, "target_line_code": "assertEquals(\"/\", this.handler.processPath(\"/\"));"}, {"target_line_num": 199, "target_line_code": "assertEquals(\"/\", this.handler.processPath(\"/ /   / \"));"}, {"target_line_num": 133, "target_line_code": "public void invalidPath() throws Exception {"}, {"target_line_num": 138, "target_line_code": "Resource location = new ClassPathResource(\"test/\", getClass());"}, {"target_line_num": 139, "target_line_code": "this.handler.setLocations(Arrays.asList(location));"}, {"target_line_num": 141, "target_line_code": "testInvalidPath(location, \"../testsecret/secret.txt\", request, response);"}, {"target_line_num": 142, "target_line_code": "testInvalidPath(location, \"test/../../testsecret/secret.txt\", request, response);"}, {"target_line_num": 143, "target_line_code": "testInvalidPath(location, \":/../../testsecret/secret.txt\", request, response);"}, {"target_line_num": 145, "target_line_code": "location = new UrlResource(getClass().getResource(\"./test/\"));"}, {"target_line_num": 146, "target_line_code": "this.handler.setLocations(Arrays.asList(location));"}, {"target_line_num": 147, "target_line_code": "Resource secretResource = new UrlResource(getClass().getResource(\"testsecret/secret.txt\"));"}, {"target_line_num": 148, "target_line_code": "String secretPath = secretResource.getURL().getPath();"}, {"target_line_num": 150, "target_line_code": "testInvalidPath(location, \"file:\" + secretPath, request, response);"}, {"target_line_num": 151, "target_line_code": "testInvalidPath(location, \"/file:\" + secretPath, request, response);"}, {"target_line_num": 152, "target_line_code": "testInvalidPath(location, \"url:\" + secretPath, request, response);"}, {"target_line_num": 153, "target_line_code": "testInvalidPath(location, \"/url:\" + secretPath, request, response);"}, {"target_line_num": 154, "target_line_code": "testInvalidPath(location, \"/\" + secretPath, request, response);"}, {"target_line_num": 156, "target_line_code": "testInvalidPath(location, \"/%2E%2E/testsecret/secret.txt\", request, response);"}, {"target_line_num": 157, "target_line_code": "testInvalidPath(location, \"/%2e%2e/testsecret/secret.txt\", request, response);"}, {"target_line_num": 158, "target_line_code": "testInvalidPath(location, \" \" + secretPath, request, response);"}, {"target_line_num": 159, "target_line_code": "testInvalidPath(location, \"/  \" + secretPath, request, response);"}, {"target_line_num": 160, "target_line_code": "testInvalidPath(location, \"url:\" + secretPath, request, response);"}, {"target_line_num": 163, "target_line_code": "@Test"}, {"target_line_num": 164, "target_line_code": "public void ignoreInvalidEscapeSequence() throws Exception {"}, {"target_line_num": 165, "target_line_code": "MockHttpServletRequest request = new MockHttpServletRequest();"}, {"target_line_num": 166, "target_line_code": "request.setMethod(\"GET\");"}, {"target_line_num": 167, "target_line_code": "MockHttpServletResponse response = new MockHttpServletResponse();"}, {"target_line_num": 168, "target_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"/%foo%/bar.txt\");"}, {"target_line_num": 170, "target_line_code": "this.handler.handleRequest(request, response);"}, {"target_line_num": 174, "target_line_code": "@Test"}, {"target_line_num": 175, "target_line_code": "public void processPath() throws Exception {"}, {"target_line_num": 176, "target_line_code": "assertSame(\"/foo/bar\", this.handler.processPath(\"/foo/bar\"));"}, {"target_line_num": 177, "target_line_code": "assertSame(\"foo/bar\", this.handler.processPath(\"foo/bar\"));"}, {"target_line_num": 180, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath(\"  /foo/bar\"));"}, {"target_line_num": 181, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 1 + \"/foo/bar\"));"}, {"target_line_num": 182, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 31 + \"/foo/bar\"));"}, {"target_line_num": 183, "target_line_code": "assertEquals(\"foo/bar\", this.handler.processPath(\"  foo/bar\"));"}, {"target_line_num": 184, "target_line_code": "assertEquals(\"foo/bar\", this.handler.processPath((char) 31 + \"foo/bar\"));"}, {"target_line_num": 187, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 127 + \"/foo/bar\"));"}, {"target_line_num": 188, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath((char) 127 + \"/foo/bar\"));"}, {"target_line_num": 191, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath(\"  /  foo/bar\"));"}, {"target_line_num": 192, "target_line_code": "assertEquals(\"/foo/bar\", this.handler.processPath(\"  /  /  foo/bar\"));"}, {"target_line_num": 197, "target_line_code": "assertEquals(\"\", this.handler.processPath(\"   \"));"}, {"target_line_num": 198, "target_line_code": "assertEquals(\"/\", this.handler.processPath(\"/\"));"}, {"target_line_num": 200, "target_line_code": "assertEquals(\"/\", this.handler.processPath(\"/ /   / \"));"}], "removed_line": [{"source_line_num": 128, "source_line_code": "public void getResourceViaDirectoryTraversal() throws Exception {"}, {"source_line_num": 132, "source_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"../testsecret/secret.txt\");"}, {"source_line_num": 134, "source_line_code": "handler.handleRequest(request, response);"}, {"source_line_num": 135, "source_line_code": "assertEquals(404, response.getStatus());"}, {"source_line_num": 137, "source_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"test/../../testsecret/secret.txt\");"}, {"source_line_num": 134, "source_line_code": "handler.handleRequest(request, response);"}, {"source_line_num": 142, "source_line_code": "handler.setLocations(Arrays.<Resource>asList(new ClassPathResource(\"testsecret/\", getClass())));"}, {"source_line_num": 143, "source_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"secret.txt\");"}, {"source_line_num": 138, "source_line_code": "response = new MockHttpServletResponse();"}, {"source_line_num": 134, "source_line_code": "handler.handleRequest(request, response);"}, {"source_line_num": 146, "source_line_code": "assertEquals(200, response.getStatus());"}, {"source_line_num": 147, "source_line_code": "assertEquals(\"text/plain\", response.getContentType());"}, {"source_line_num": 148, "source_line_code": "assertEquals(\"big secret\", response.getContentAsString());"}, {"source_line_num": 129, "source_line_code": "public void getResourceViaDirectoryTraversal() throws Exception {"}, {"source_line_num": 133, "source_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"../testsecret/secret.txt\");"}, {"source_line_num": 135, "source_line_code": "handler.handleRequest(request, response);"}, {"source_line_num": 136, "source_line_code": "assertEquals(404, response.getStatus());"}, {"source_line_num": 138, "source_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"test/../../testsecret/secret.txt\");"}, {"source_line_num": 140, "source_line_code": "handler.handleRequest(request, response);"}, {"source_line_num": 143, "source_line_code": "handler.setLocations(Arrays.<Resource>asList(new ClassPathResource(\"testsecret/\", getClass())));"}, {"source_line_num": 144, "source_line_code": "request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE, \"secret.txt\");"}, {"source_line_num": 145, "source_line_code": "response = new MockHttpServletResponse();"}, {"source_line_num": 146, "source_line_code": "handler.handleRequest(request, response);"}, {"source_line_num": 147, "source_line_code": "assertEquals(200, response.getStatus());"}, {"source_line_num": 148, "source_line_code": "assertEquals(\"text/plain\", response.getContentType());"}, {"source_line_num": 149, "source_line_code": "assertEquals(\"big secret\", response.getContentAsString());"}], "filename": "spring-webmvc/src/test/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandlerTests.java", "patch_func": "no", "diff_file": "spring-framework_CVE-2014-3625_9beae9ae4226c45cd428035dae81214439324676.diff", "patch_tag": "v4.0.8.RELEASE", "source_tag": "v4.0.7.RELEASE"}]