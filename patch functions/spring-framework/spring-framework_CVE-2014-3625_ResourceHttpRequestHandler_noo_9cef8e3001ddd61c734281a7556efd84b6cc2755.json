[{"cve_id": "spring-framework", "added_line": [{"target_line_num": 281, "target_line_code": "* Process the given resource path to be used."}, {"target_line_num": 282, "target_line_code": "* <p>The default implementation replaces any combination of leading '/' and"}, {"target_line_num": 283, "target_line_code": "* control characters (00-1F and 7F) with a single \"/\" or \"\". For example"}, {"target_line_num": 285, "target_line_code": "* @since 3.2.12"}, {"target_line_num": 286, "target_line_code": "*/"}, {"target_line_num": 287, "target_line_code": "protected String processPath(String path) {"}, {"target_line_num": 288, "target_line_code": "boolean slash = false;"}, {"target_line_num": 289, "target_line_code": "for (int i = 0; i < path.length(); i++) {"}, {"target_line_num": 290, "target_line_code": "if (path.charAt(i) == '/') {"}, {"target_line_num": 291, "target_line_code": "slash = true;"}, {"target_line_num": 293, "target_line_code": "else if (path.charAt(i) > ' ' && path.charAt(i) != 127) {"}, {"target_line_num": 294, "target_line_code": "if (i == 0 || (i == 1 && slash)) {"}, {"target_line_num": 295, "target_line_code": "return path;"}, {"target_line_num": 297, "target_line_code": "path = slash ? \"/\" + path.substring(i) : path.substring(i);"}, {"target_line_num": 298, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 299, "target_line_code": "logger.trace(\"Path after trimming leading '/' and control characters: \" + path);"}, {"target_line_num": 295, "target_line_code": "return path;"}, {"target_line_num": 304, "target_line_code": "return (slash ? \"/\" : \"\");"}, {"target_line_num": 308, "target_line_code": "* Identifies invalid resource paths. By default rejects:"}, {"target_line_num": 309, "target_line_code": "* <ul>"}, {"target_line_num": 310, "target_line_code": "* <li>Paths that contain \"WEB-INF\" or \"META-INF\""}, {"target_line_num": 311, "target_line_code": "* <li>Paths that contain \"../\" after a call to"}, {"target_line_num": 312, "target_line_code": "* {@link org.springframework.util.StringUtils#cleanPath}."}, {"target_line_num": 313, "target_line_code": "* <li>Paths that represent a {@link org.springframework.util.ResourceUtils#isUrl"}, {"target_line_num": 314, "target_line_code": "* valid URL} or would represent one after the leading slash is removed."}, {"target_line_num": 315, "target_line_code": "* </ul>"}, {"target_line_num": 316, "target_line_code": "* <p><strong>Note:</strong> this method assumes that leading, duplicate '/'"}, {"target_line_num": 317, "target_line_code": "* or control characters (e.g. white space) have been trimmed so that the"}, {"target_line_num": 318, "target_line_code": "* path starts predictably with a single '/' or does not have one."}, {"target_line_num": 320, "target_line_code": "* @return {@code true} if the path is invalid, {@code false} otherwise"}, {"target_line_num": 323, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 324, "target_line_code": "logger.trace(\"Applying \\\"invalid path\\\" checks to path: \" + path);"}, {"target_line_num": 326, "target_line_code": "if (path.contains(\"WEB-INF\") || path.contains(\"META-INF\")) {"}, {"target_line_num": 323, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 328, "target_line_code": "logger.trace(\"Path contains \\\"WEB-INF\\\" or \\\"META-INF\\\".\");"}, {"target_line_num": 330, "target_line_code": "return true;"}, {"target_line_num": 332, "target_line_code": "if (path.contains(\":/\")) {"}, {"target_line_num": 333, "target_line_code": "String relativePath = (path.charAt(0) == '/' ? path.substring(1) : path);"}, {"target_line_num": 334, "target_line_code": "if (ResourceUtils.isUrl(relativePath) || relativePath.startsWith(\"url:\")) {"}, {"target_line_num": 323, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 336, "target_line_code": "logger.trace(\"Path represents URL or has \\\"url:\\\" prefix.\");"}, {"target_line_num": 330, "target_line_code": "return true;"}, {"target_line_num": 341, "target_line_code": "if (path.contains(\"../\")) {"}, {"target_line_num": 342, "target_line_code": "path = StringUtils.cleanPath(path);"}, {"target_line_num": 341, "target_line_code": "if (path.contains(\"../\")) {"}, {"target_line_num": 323, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 345, "target_line_code": "logger.trace(\"Path contains \\\"../\\\" after call to StringUtils#cleanPath.\");"}, {"target_line_num": 330, "target_line_code": "return true;"}, {"target_line_num": 350, "target_line_code": "return false;"}, {"target_line_num": 282, "target_line_code": "* Process the given resource path to be used."}, {"target_line_num": 283, "target_line_code": "* <p>The default implementation replaces any combination of leading '/' and"}, {"target_line_num": 284, "target_line_code": "* control characters (00-1F and 7F) with a single \"/\" or \"\". For example"}, {"target_line_num": 286, "target_line_code": "* @since 3.2.12"}, {"target_line_num": 287, "target_line_code": "*/"}, {"target_line_num": 288, "target_line_code": "protected String processPath(String path) {"}, {"target_line_num": 289, "target_line_code": "boolean slash = false;"}, {"target_line_num": 290, "target_line_code": "for (int i = 0; i < path.length(); i++) {"}, {"target_line_num": 291, "target_line_code": "if (path.charAt(i) == '/') {"}, {"target_line_num": 292, "target_line_code": "slash = true;"}, {"target_line_num": 294, "target_line_code": "else if (path.charAt(i) > ' ' && path.charAt(i) != 127) {"}, {"target_line_num": 295, "target_line_code": "if (i == 0 || (i == 1 && slash)) {"}, {"target_line_num": 296, "target_line_code": "return path;"}, {"target_line_num": 298, "target_line_code": "path = slash ? \"/\" + path.substring(i) : path.substring(i);"}, {"target_line_num": 299, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 300, "target_line_code": "logger.trace(\"Path after trimming leading '/' and control characters: \" + path);"}, {"target_line_num": 302, "target_line_code": "return path;"}, {"target_line_num": 305, "target_line_code": "return (slash ? \"/\" : \"\");"}, {"target_line_num": 308, "target_line_code": "/**"}, {"target_line_num": 309, "target_line_code": "* Identifies invalid resource paths. By default rejects:"}, {"target_line_num": 310, "target_line_code": "* <ul>"}, {"target_line_num": 311, "target_line_code": "* <li>Paths that contain \"WEB-INF\" or \"META-INF\""}, {"target_line_num": 312, "target_line_code": "* <li>Paths that contain \"../\" after a call to"}, {"target_line_num": 313, "target_line_code": "* {@link org.springframework.util.StringUtils#cleanPath}."}, {"target_line_num": 314, "target_line_code": "* <li>Paths that represent a {@link org.springframework.util.ResourceUtils#isUrl"}, {"target_line_num": 315, "target_line_code": "* valid URL} or would represent one after the leading slash is removed."}, {"target_line_num": 316, "target_line_code": "* </ul>"}, {"target_line_num": 317, "target_line_code": "* <p><strong>Note:</strong> this method assumes that leading, duplicate '/'"}, {"target_line_num": 318, "target_line_code": "* or control characters (e.g. white space) have been trimmed so that the"}, {"target_line_num": 319, "target_line_code": "* path starts predictably with a single '/' or does not have one."}, {"target_line_num": 321, "target_line_code": "* @return {@code true} if the path is invalid, {@code false} otherwise"}, {"target_line_num": 324, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 325, "target_line_code": "logger.trace(\"Applying \\\"invalid path\\\" checks to path: \" + path);"}, {"target_line_num": 327, "target_line_code": "if (path.contains(\"WEB-INF\") || path.contains(\"META-INF\")) {"}, {"target_line_num": 328, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 329, "target_line_code": "logger.trace(\"Path contains \\\"WEB-INF\\\" or \\\"META-INF\\\".\");"}, {"target_line_num": 331, "target_line_code": "return true;"}, {"target_line_num": 333, "target_line_code": "if (path.contains(\":/\")) {"}, {"target_line_num": 334, "target_line_code": "String relativePath = (path.charAt(0) == '/' ? path.substring(1) : path);"}, {"target_line_num": 335, "target_line_code": "if (ResourceUtils.isUrl(relativePath) || relativePath.startsWith(\"url:\")) {"}, {"target_line_num": 336, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 337, "target_line_code": "logger.trace(\"Path represents URL or has \\\"url:\\\" prefix.\");"}, {"target_line_num": 339, "target_line_code": "return true;"}, {"target_line_num": 342, "target_line_code": "if (path.contains(\"../\")) {"}, {"target_line_num": 343, "target_line_code": "path = StringUtils.cleanPath(path);"}, {"target_line_num": 344, "target_line_code": "if (path.contains(\"../\")) {"}, {"target_line_num": 345, "target_line_code": "if (logger.isTraceEnabled()) {"}, {"target_line_num": 346, "target_line_code": "logger.trace(\"Path contains \\\"../\\\" after call to StringUtils#cleanPath.\");"}, {"target_line_num": 348, "target_line_code": "return true;"}, {"target_line_num": 351, "target_line_code": "return false;"}], "removed_line": [{"source_line_num": 240, "source_line_code": "* Validates the given path: returns {@code true} if the given path is not a valid resource path."}, {"source_line_num": 241, "source_line_code": "* <p>The default implementation rejects paths containing \"WEB-INF\" or \"META-INF\" as well as paths"}, {"source_line_num": 242, "source_line_code": "* with relative paths (\"../\") that result in access of a parent directory."}, {"source_line_num": 244, "source_line_code": "* @return {@code true} if the path has been recognized as invalid, {@code false} otherwise"}, {"source_line_num": 247, "source_line_code": "return (path.contains(\"WEB-INF\") || path.contains(\"META-INF\") || StringUtils.cleanPath(path).startsWith(\"..\"));"}, {"source_line_num": 241, "source_line_code": "* Validates the given path: returns {@code true} if the given path is not a valid resource path."}, {"source_line_num": 242, "source_line_code": "* <p>The default implementation rejects paths containing \"WEB-INF\" or \"META-INF\" as well as paths"}, {"source_line_num": 243, "source_line_code": "* with relative paths (\"../\") that result in access of a parent directory."}, {"source_line_num": 245, "source_line_code": "* @return {@code true} if the path has been recognized as invalid, {@code false} otherwise"}, {"source_line_num": 248, "source_line_code": "return (path.contains(\"WEB-INF\") || path.contains(\"META-INF\") || StringUtils.cleanPath(path).startsWith(\"..\"));"}], "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java", "patch_func": "no", "diff_file": "spring-framework_CVE-2014-3625_9cef8e3001ddd61c734281a7556efd84b6cc2755.diff", "patch_tag": "v4.1.2.RELEASE", "source_tag": "v4.1.1.RELEASE"}]