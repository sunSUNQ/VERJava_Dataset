[{"cve_id": "spring-framework", "added_line": [{"target_line_num": 165, "target_line_code": "initAllowedLocations();"}, {"target_line_num": 168, "target_line_code": "/**"}, {"target_line_num": 169, "target_line_code": "* Look for a {@link org.springframework.web.servlet.resource.PathResourceResolver}"}, {"target_line_num": 170, "target_line_code": "* among the {@link #getResourceResolvers() resource resolvers} and configure"}, {"target_line_num": 171, "target_line_code": "* its {@code \"allowedLocations\"} to match the value of the"}, {"target_line_num": 172, "target_line_code": "* {@link #setLocations(java.util.List) locations} property unless the \"allowed"}, {"target_line_num": 173, "target_line_code": "* locations\" of the {@code PathResourceResolver} is non-empty."}, {"target_line_num": 174, "target_line_code": "*/"}, {"target_line_num": 175, "target_line_code": "protected void initAllowedLocations() {"}, {"target_line_num": 176, "target_line_code": "if (CollectionUtils.isEmpty(this.locations)) {"}, {"target_line_num": 177, "target_line_code": "return;"}, {"target_line_num": 179, "target_line_code": "for (int i = getResourceResolvers().size()-1; i >= 0; i--) {"}, {"target_line_num": 180, "target_line_code": "if (getResourceResolvers().get(i) instanceof PathResourceResolver) {"}, {"target_line_num": 181, "target_line_code": "PathResourceResolver pathResolver = (PathResourceResolver) getResourceResolvers().get(i);"}, {"target_line_num": 182, "target_line_code": "if (ObjectUtils.isEmpty(pathResolver.getAllowedLocations())) {"}, {"target_line_num": 183, "target_line_code": "pathResolver.setAllowedLocations(getLocations().toArray(new Resource[getLocations().size()]));"}, {"target_line_num": 185, "target_line_code": "break;"}], "removed_line": [], "filename": "spring-webmvc/src/main/java/org/springframework/web/servlet/resource/ResourceHttpRequestHandler.java", "patch_func": "initAllowedLocations", "diff_file": "spring-framework_CVE-2014-3625_9cef8e3001ddd61c734281a7556efd84b6cc2755.diff", "patch_tag": "v4.1.2.RELEASE", "source_tag": "v4.1.1.RELEASE"}]