[{"cve_id": "struts", "added_line": [{"target_line_num": 42, "target_line_code": "public void testTokenSessionNameBuilding() throws Exception {"}, {"target_line_num": 43, "target_line_code": "String name = \"foo\";"}, {"target_line_num": 44, "target_line_code": "String sessionName = TokenHelper.buildTokenSessionAttributeName(name);"}, {"target_line_num": 45, "target_line_code": "assertEquals(TokenHelper.TOKEN_NAMESPACE + \".\" + name, sessionName);"}, {"target_line_num": 50, "target_line_code": "final String defaultSessionTokenName = TokenHelper.buildTokenSessionAttributeName(TokenHelper.DEFAULT_TOKEN_NAME);"}, {"target_line_num": 51, "target_line_code": "assertEquals(token, session.get(defaultSessionTokenName));"}, {"target_line_num": 57, "target_line_code": "final String sessionTokenName = TokenHelper.buildTokenSessionAttributeName(tokenName);"}, {"target_line_num": 58, "target_line_code": "assertEquals(token, session.get(sessionTokenName));"}, {"target_line_num": 61, "target_line_code": "public void testSetSessionToken() {"}, {"target_line_num": 62, "target_line_code": "String tokenName = \"myOtherTestToken\";"}, {"target_line_num": 63, "target_line_code": "String token = \"foobar\";"}, {"target_line_num": 64, "target_line_code": "TokenHelper.setSessionToken(tokenName, token);"}, {"target_line_num": 65, "target_line_code": "final String sessionTokenName = TokenHelper.buildTokenSessionAttributeName(tokenName);"}, {"target_line_num": 66, "target_line_code": "assertEquals(token, session.get(sessionTokenName));"}, {"target_line_num": 69, "target_line_code": "public void testValidToken() {"}, {"target_line_num": 72, "target_line_code": "final String sessionTokenName = TokenHelper.buildTokenSessionAttributeName(tokenName);"}, {"target_line_num": 73, "target_line_code": "assertEquals(token, session.get(sessionTokenName));"}], "removed_line": [{"source_line_num": 45, "source_line_code": "assertEquals(token, session.get(TokenHelper.DEFAULT_TOKEN_NAME));"}, {"source_line_num": 51, "source_line_code": "assertEquals(token, session.get(tokenName));"}, {"source_line_num": 54, "source_line_code": "public void testValidToken() {"}, {"source_line_num": 57, "source_line_code": "assertEquals(token, session.get(tokenName));"}], "filename": "core/src/test/java/org/apache/struts2/util/TokenHelperTest.java", "patch_func": "no", "diff_file": "struts_CVE-2012-4386_a1ca307981b0930d1687ed89f0b7305af79da0f3.diff", "patch_tag": "STRUTS_6_0_0_RC1", "source_tag": "STRUTS_2_5_BETA3"}]