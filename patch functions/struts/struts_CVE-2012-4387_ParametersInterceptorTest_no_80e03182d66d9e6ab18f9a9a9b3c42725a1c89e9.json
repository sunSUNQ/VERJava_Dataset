[{"cve_id": "struts", "added_line": [{"target_line_num": 205, "target_line_code": "public void testLargeParameterNameWithDefaultLimit() throws Exception {"}, {"target_line_num": 206, "target_line_code": "ParametersInterceptor parametersInterceptor = createParametersInterceptor();"}, {"target_line_num": 207, "target_line_code": "doTestParameterNameLengthRestriction(parametersInterceptor, ParametersInterceptor.PARAM_NAME_MAX_LENGTH);"}, {"target_line_num": 210, "target_line_code": "public void testLargeParameterNameWithCustomLimit() throws Exception {"}, {"target_line_num": 211, "target_line_code": "ParametersInterceptor parametersInterceptor = createParametersInterceptor();"}, {"target_line_num": 212, "target_line_code": "int limit = 20;"}, {"target_line_num": 213, "target_line_code": "parametersInterceptor.setParamNameMaxLength(limit);"}, {"target_line_num": 214, "target_line_code": "doTestParameterNameLengthRestriction(parametersInterceptor, limit);"}, {"target_line_num": 217, "target_line_code": "private void doTestParameterNameLengthRestriction( ParametersInterceptor parametersInterceptor,"}, {"target_line_num": 218, "target_line_code": "int paramNameMaxLength ) {"}, {"target_line_num": 219, "target_line_code": "StringBuilder sb = new StringBuilder();"}, {"target_line_num": 220, "target_line_code": "for (int i = 0; i < paramNameMaxLength + 1; i++) {"}, {"target_line_num": 221, "target_line_code": "sb.append(\"x\");"}, {"target_line_num": 224, "target_line_code": "Map<String, Object> actual = new LinkedHashMap<String, Object>();"}, {"target_line_num": 225, "target_line_code": "parametersInterceptor.setValueStackFactory(createValueStackFactory(actual));"}, {"target_line_num": 226, "target_line_code": "ValueStack stack = createStubValueStack(actual);"}, {"target_line_num": 228, "target_line_code": "Map<String, Object> parameters = new HashMap<String, Object>();"}, {"target_line_num": 229, "target_line_code": "parameters.put(sb.toString(), \"\");"}, {"target_line_num": 230, "target_line_code": "parameters.put(\"huuhaa\", \"\");"}, {"target_line_num": 232, "target_line_code": "Action action = new SimpleAction();"}, {"target_line_num": 233, "target_line_code": "parametersInterceptor.setParameters(action, stack, parameters);"}, {"target_line_num": 234, "target_line_code": "assertEquals(1, actual.size());"}, {"target_line_num": 237, "target_line_code": "public void testExcludedTrickyParameters() throws Exception {"}], "removed_line": [{"source_line_num": 204, "source_line_code": "public void testExcludedTrickyParameters() throws Exception {"}], "filename": "xwork-core/src/test/java/com/opensymphony/xwork2/interceptor/ParametersInterceptorTest.java", "patch_func": "no", "diff_file": "struts_CVE-2012-4387_80e03182d66d9e6ab18f9a9a9b3c42725a1c89e9.diff", "patch_tag": "STRUTS_6_0_0_RC1", "source_tag": "STRUTS_2_5_BETA3"}]