[{"cve_id": "struts", 
	"added_line": [
		{"target_line_num": 88, "target_line_code": "/**"}, 
		{"target_line_num": 89, "target_line_code": "* See WW-3668"}, 
		{"target_line_num": 90, "target_line_code": "* @throws Exception"}, 
		{"target_line_num": 91, "target_line_code": "*/"}, 
		{"target_line_num": 92, "target_line_code": "public void testWithPreResultListenerAgainstMaliciousCode() throws Exception {"}, 
		{"target_line_num": 93, "target_line_code": "conversionErrors.put(\"foo\", \"' + #root + '\");"}, {"target_line_num": 95, "target_line_code": "ActionContext ac = createActionContext();"}, {"target_line_num": 97, "target_line_code": "MockActionInvocation mai = createActionInvocation(ac);"}, {"target_line_num": 99, "target_line_code": "SimpleAction action = createAction(mai);"}, {"target_line_num": 100, "target_line_code": "assertNull(action.getFieldErrors().get(\"foo\"));"}, {"target_line_num": 101, "target_line_code": "assertEquals(55, stack.findValue(\"foo\"));"}, {"target_line_num": 103, "target_line_code": "interceptor.intercept(mai);"}, {"target_line_num": 105, "target_line_code": "assertTrue(action.hasFieldErrors());"}, {"target_line_num": 106, "target_line_code": "assertNotNull(action.getFieldErrors().get(\"foo\"));"}, {"target_line_num": 108, "target_line_code": "assertEquals(\"' + #root + '\", stack.findValue(\"foo\"));"}, {"target_line_num": 111, "target_line_code": "private MockActionInvocation createActionInvocation(ActionContext ac) {"}, {"target_line_num": 112, "target_line_code": "MockActionInvocation mai = new MockActionInvocation();"}, {"target_line_num": 113, "target_line_code": "mai.setInvocationContext(ac);"}, {"target_line_num": 114, "target_line_code": "mai.setStack(stack);"}, {"target_line_num": 115, "target_line_code": "return mai;"}, {"target_line_num": 118, "target_line_code": "private SimpleAction createAction(MockActionInvocation mai) {"}, {"target_line_num": 119, "target_line_code": "SimpleAction action = new SimpleAction();"}, {"target_line_num": 120, "target_line_code": "action.setFoo(55);"}, {"target_line_num": 121, "target_line_code": "mai.setAction(action);"}, {"target_line_num": 122, "target_line_code": "stack.push(action);"}, {"target_line_num": 123, "target_line_code": "return action;"}, {"target_line_num": 126, "target_line_code": "private ActionContext createActionContext() {"}, {"target_line_num": 127, "target_line_code": "ActionContext ac = new ActionContext(stack.getContext());"}, {"target_line_num": 128, "target_line_code": "ac.setConversionErrors(conversionErrors);"}, {"target_line_num": 129, "target_line_code": "ac.setValueStack(stack);"}, {"target_line_num": 130, "target_line_code": "return ac;"}], "removed_line": [], "filename": "xwork-core/src/test/java/com/opensymphony/xwork2/interceptor/ConversionErrorInterceptorTest.java", "patch_func": "no", "diff_file": "struts_CVE-2012-0391_5f54b8d087f5125d96838aafa5f64c2190e6885b.diff", "patch_tag": "STRUTS_6_0_0_RC1", "source_tag": "STRUTS_2_5_BETA3"}]