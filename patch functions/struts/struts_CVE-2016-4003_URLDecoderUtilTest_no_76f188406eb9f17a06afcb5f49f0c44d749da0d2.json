[{"cve_id": "struts", "added_line": [{"target_line_num": 2, "target_line_code": "package org.apache.struts2.util;"}, {"target_line_num": 4, "target_line_code": "import org.junit.Test;"}, {"target_line_num": 6, "target_line_code": "import static org.junit.Assert.*;"}, {"target_line_num": 8, "target_line_code": "public class URLDecoderUtilTest {"}, {"target_line_num": 10, "target_line_code": "@Test"}, {"target_line_num": 11, "target_line_code": "public void testURLDecodeStringInvalid() {"}, {"target_line_num": 13, "target_line_code": "Exception exception = null;"}, {"target_line_num": 14, "target_line_code": "try {"}, {"target_line_num": 15, "target_line_code": "URLDecoderUtil.decode(\"%5xxxxx\", \"ISO-8859-1\");"}, {"target_line_num": 16, "target_line_code": "} catch (Exception e) {"}, {"target_line_num": 17, "target_line_code": "exception = e;"}, {"target_line_num": 19, "target_line_code": "assertTrue(exception instanceof IllegalArgumentException);"}, {"target_line_num": 22, "target_line_code": "exception = null;"}, {"target_line_num": 23, "target_line_code": "try {"}, {"target_line_num": 24, "target_line_code": "URLDecoderUtil.decode(\"%5\", \"ISO-8859-1\");"}, {"target_line_num": 25, "target_line_code": "} catch (Exception e) {"}, {"target_line_num": 26, "target_line_code": "exception = e;"}, {"target_line_num": 28, "target_line_code": "assertTrue(exception instanceof IllegalArgumentException);"}, {"target_line_num": 31, "target_line_code": "@Test"}, {"target_line_num": 32, "target_line_code": "public void testURLDecodeStringValidIso88591Start() {"}, {"target_line_num": 34, "target_line_code": "String result = URLDecoderUtil.decode(\"%41xxxx\", \"ISO-8859-1\");"}, {"target_line_num": 35, "target_line_code": "assertEquals(\"Axxxx\", result);"}, {"target_line_num": 38, "target_line_code": "@Test"}, {"target_line_num": 39, "target_line_code": "public void testURLDecodeStringValidIso88591Middle() {"}, {"target_line_num": 41, "target_line_code": "String result = URLDecoderUtil.decode(\"xx%41xx\", \"ISO-8859-1\");"}, {"target_line_num": 42, "target_line_code": "assertEquals(\"xxAxx\", result);"}, {"target_line_num": 45, "target_line_code": "@Test"}, {"target_line_num": 46, "target_line_code": "public void testURLDecodeStringValidIso88591End() {"}, {"target_line_num": 48, "target_line_code": "String result = URLDecoderUtil.decode(\"xxxx%41\", \"ISO-8859-1\");"}, {"target_line_num": 49, "target_line_code": "assertEquals(\"xxxxA\", result);"}, {"target_line_num": 52, "target_line_code": "@Test"}, {"target_line_num": 53, "target_line_code": "public void testURLDecodeStringValidUtf8Start() {"}, {"target_line_num": 54, "target_line_code": "String result = URLDecoderUtil.decode(\"%c3%aaxxxx\", \"UTF-8\");"}, {"target_line_num": 55, "target_line_code": "assertEquals(\"\\u00eaxxxx\", result);"}, {"target_line_num": 58, "target_line_code": "@Test"}, {"target_line_num": 59, "target_line_code": "public void testURLDecodeStringValidUtf8Middle() {"}, {"target_line_num": 61, "target_line_code": "String result = URLDecoderUtil.decode(\"xx%c3%aaxx\", \"UTF-8\");"}, {"target_line_num": 62, "target_line_code": "assertEquals(\"xx\\u00eaxx\", result);"}, {"target_line_num": 65, "target_line_code": "@Test"}, {"target_line_num": 66, "target_line_code": "public void testURLDecodeStringValidUtf8End() {"}, {"target_line_num": 68, "target_line_code": "String result = URLDecoderUtil.decode(\"xxxx%c3%aa\", \"UTF-8\");"}, {"target_line_num": 69, "target_line_code": "assertEquals(\"xxxx\\u00ea\", result);"}], "removed_line": [], "filename": "core/src/test/java/org/apache/struts2/util/URLDecoderUtilTest.java", "patch_func": "no", "diff_file": "struts_CVE-2016-4003_76f188406eb9f17a06afcb5f49f0c44d749da0d2.diff", "patch_tag": "STRUTS_6_0_0_RC1", "source_tag": "STRUTS_2_5_BETA3"}]