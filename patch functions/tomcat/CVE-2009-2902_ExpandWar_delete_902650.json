[{"cve_id": "CVE-2009-2902", "added_line": [{"target_line_num": 346, "target_line_code": "return delete(dir, true);"}, {"target_line_num": 349, "target_line_code": "/**"}, {"target_line_num": 357, "target_line_code": "public static boolean delete(File dir, boolean logFailure) {"}, {"target_line_num": 358, "target_line_code": "boolean result;"}, {"target_line_num": 360, "target_line_code": "result = deleteDir(dir, logFailure);"}, {"target_line_num": 362, "target_line_code": "if (dir.exists()) {"}, {"target_line_num": 363, "target_line_code": "result = dir.delete();"}, {"target_line_num": 364, "target_line_code": "} else {"}, {"target_line_num": 365, "target_line_code": "result = true;"}, {"target_line_num": 368, "target_line_code": "if (logFailure && !result) {"}, {"target_line_num": 369, "target_line_code": "log.error(sm.getString("}, {"target_line_num": 370, "target_line_code": "\"expandWar.deleteFailed\", dir.getAbsolutePath()));"}, {"target_line_num": 372, "target_line_code": "return result;"}, {"target_line_num": 383, "target_line_code": "return deleteDir(dir, true);"}, {"target_line_num": 386, "target_line_code": "/**"}, {"target_line_num": 394, "target_line_code": "public static boolean deleteDir(File dir, boolean logFailure) {"}], "removed_line": [{"source_line_num": 266, "source_line_code": "return deleteDir(dir);"}, {"source_line_num": 268, "source_line_code": "return dir.delete();"}], "filename": "archive/tc5.5.x/trunk/container/catalina/src/share/org/apache/catalina/startup/ExpandWar.java", "patch_func": "delete", "diff_file": "CVE-2009-2902_902650.diff", "patch_tag": "5.5.29", "source_tag": "5.5.28"}]