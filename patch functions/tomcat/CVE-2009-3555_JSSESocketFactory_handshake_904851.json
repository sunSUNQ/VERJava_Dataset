[{"cve_id": "CVE-2009-3555", "added_line": [{"target_line_num": 134, "target_line_code": "if (!allowUnsafeLegacyRenegotiation) {"}, {"target_line_num": 136, "target_line_code": "((SSLSocket) sock).setEnabledCipherSuites(new String[0]);"}], "removed_line": [{"source_line_num": 136, "source_line_code": "private static class DisableSslRenegotiation"}, {"source_line_num": 137, "source_line_code": "implements HandshakeCompletedListener {"}, {"source_line_num": 138, "source_line_code": "private volatile boolean completed = false;"}, {"source_line_num": 140, "source_line_code": "public void handshakeCompleted(HandshakeCompletedEvent event) {"}, {"source_line_num": 141, "source_line_code": "if (completed) {"}, {"source_line_num": 151, "source_line_code": "try {"}, {"source_line_num": 143, "source_line_code": "log.warn(\"SSL renegotiation is disabled, closing connection\");"}, {"source_line_num": 144, "source_line_code": "event.getSession().invalidate();"}, {"source_line_num": 145, "source_line_code": "event.getSocket().close();"}, {"source_line_num": 146, "source_line_code": "} catch (IOException e) {"}, {"source_line_num": 150, "source_line_code": "completed = true;"}, {"source_line_num": 151, "source_line_code": "try {"}], "filename": "archive/tc5.5.x/trunk/connectors/util/java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java", "patch_func": "no", "diff_file": "CVE-2009-3555_904851.diff", "patch_tag": "6.0.26", "source_tag": "6.0.24"}]