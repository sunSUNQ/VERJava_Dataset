[{"cve_id": "CVE-2009-2901", "added_line": [{"target_line_num": 873, "target_line_code": "String pathName = context.getPath();"}, {"target_line_num": 874, "target_line_code": "if (pathName.equals(\"\")) {"}, {"target_line_num": 875, "target_line_code": "pathName = \"ROOT\";"}, {"target_line_num": 878, "target_line_code": "pathName = pathName.substring(1).replace('/', '#');"}, {"target_line_num": 882, "target_line_code": "docBase = ExpandWar.expand(host, war, pathName);"}, {"target_line_num": 888, "target_line_code": "} else if (docBase.toLowerCase().endsWith(\".war\") &&"}, {"target_line_num": 889, "target_line_code": "!file.isDirectory() && !unpackWARs) {"}, {"target_line_num": 890, "target_line_code": "URL war ="}, {"target_line_num": 891, "target_line_code": "new URL(\"jar:\" + (new File (docBase)).toURI().toURL() + \"!/\");"}, {"target_line_num": 892, "target_line_code": "ExpandWar.validate(host, war, pathName);"}, {"target_line_num": 890, "target_line_code": "URL war ="}, {"target_line_num": 899, "target_line_code": "new URL(\"jar:\" + warFile.toURI().toURL() + \"!/\");"}, {"target_line_num": 901, "target_line_code": "docBase = ExpandWar.expand(host, war, pathName);"}, {"target_line_num": 906, "target_line_code": "ExpandWar.validate(host, war, pathName);"}, {"target_line_num": 873, "target_line_code": "String pathName = context.getPath();"}, {"target_line_num": 874, "target_line_code": "if (pathName.equals(\"\")) {"}, {"target_line_num": 875, "target_line_code": "pathName = \"ROOT\";"}, {"target_line_num": 878, "target_line_code": "pathName = pathName.substring(1).replace('/', '#');"}, {"target_line_num": 884, "target_line_code": "docBase = ExpandWar.expand(host, war, pathName);"}, {"target_line_num": 888, "target_line_code": "} else if (docBase.toLowerCase().endsWith(\".war\") &&"}, {"target_line_num": 889, "target_line_code": "!file.isDirectory() && !unpackWARs) {"}, {"target_line_num": 890, "target_line_code": "URL war ="}, {"target_line_num": 891, "target_line_code": "new URL(\"jar:\" + (new File (docBase)).toURI().toURL() + \"!/\");"}, {"target_line_num": 894, "target_line_code": "ExpandWar.validate(host, war, pathName);"}, {"target_line_num": 890, "target_line_code": "URL war ="}, {"target_line_num": 899, "target_line_code": "new URL(\"jar:\" + warFile.toURI().toURL() + \"!/\");"}, {"target_line_num": 903, "target_line_code": "docBase = ExpandWar.expand(host, war, pathName);"}, {"target_line_num": 908, "target_line_code": "ExpandWar.validate(host, war, pathName);"}], "removed_line": [{"source_line_num": 873, "source_line_code": "String contextPath = context.getPath();"}, {"source_line_num": 874, "source_line_code": "if (contextPath.equals(\"\")) {"}, {"source_line_num": 875, "source_line_code": "contextPath = \"ROOT\";"}, {"source_line_num": 877, "source_line_code": "if (contextPath.lastIndexOf('/') > 0) {"}, {"source_line_num": 878, "source_line_code": "contextPath = \"/\" + contextPath.substring(1).replace('/','#');"}, {"source_line_num": 883, "source_line_code": "docBase = ExpandWar.expand(host, war, contextPath);"}, {"source_line_num": 895, "source_line_code": "URL war ="}, {"source_line_num": 896, "source_line_code": "new URL(\"jar:\" + warFile.toURI().toURL() + \"!/\");"}, {"source_line_num": 897, "source_line_code": "docBase = ExpandWar.expand(host, war, contextPath);"}, {"source_line_num": 873, "source_line_code": "String contextPath = context.getPath();"}, {"source_line_num": 874, "source_line_code": "if (contextPath.equals(\"\")) {"}, {"source_line_num": 875, "source_line_code": "contextPath = \"ROOT\";"}, {"source_line_num": 877, "source_line_code": "if (contextPath.lastIndexOf('/') > 0) {"}, {"source_line_num": 878, "source_line_code": "contextPath = \"/\" + contextPath.substring(1).replace('/','#');"}, {"source_line_num": 885, "source_line_code": "docBase = ExpandWar.expand(host, war, contextPath);"}, {"source_line_num": 895, "source_line_code": "URL war ="}, {"source_line_num": 896, "source_line_code": "new URL(\"jar:\" + warFile.toURI().toURL() + \"!/\");"}, {"source_line_num": 899, "source_line_code": "docBase = ExpandWar.expand(host, war, contextPath);"}], "filename": "archive/tc6.0.x/trunk/java/org/apache/catalina/startup/ContextConfig.java", "patch_func": "fixDocBase", "diff_file": "CVE-2009-2901_892815.diff", "patch_tag": "6.0.24", "source_tag": "6.0.20"}]