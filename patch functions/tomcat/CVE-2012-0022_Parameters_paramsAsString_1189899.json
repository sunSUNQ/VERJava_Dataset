[{"cve_id": "CVE-2012-0022", "added_line": [{"target_line_num": 392, "target_line_code": "bc.getLength(), getCharset(encoding));"}, {"target_line_num": 395, "target_line_code": "private Charset getCharset(String encoding) {"}, {"target_line_num": 396, "target_line_code": "if (encoding == null) {"}, {"target_line_num": 397, "target_line_code": "return DEFAULT_CHARSET;"}, {"target_line_num": 399, "target_line_code": "try {"}, {"target_line_num": 400, "target_line_code": "return B2CConverter.getCharset(encoding);"}, {"target_line_num": 401, "target_line_code": "} catch (UnsupportedEncodingException e) {"}, {"target_line_num": 402, "target_line_code": "return DEFAULT_CHARSET;"}, {"target_line_num": 410, "target_line_code": "Enumeration<String> en= paramHashValues.keys();"}, {"target_line_num": 414, "target_line_code": "ArrayList<String> values = paramHashValues.get(k);"}, {"target_line_num": 415, "target_line_code": "for(String value : values) {"}, {"target_line_num": 416, "target_line_code": "sb.append(value).append(\",\");"}, {"target_line_num": 417, "target_line_code": "sb.append(\"\\n\");"}], "removed_line": [{"source_line_num": 346, "source_line_code": "bc.getLength(), encoding);"}, {"source_line_num": 353, "source_line_code": "Enumeration<String> en= paramHashStringArray.keys();"}, {"source_line_num": 357, "source_line_code": "String v[] = paramHashStringArray.get( k );"}, {"source_line_num": 358, "source_line_code": "for( int i=0; i<v.length; i++ )"}, {"source_line_num": 359, "source_line_code": "sb.append( v[i] ).append(\",\");"}, {"source_line_num": 360, "source_line_code": "sb.append(\"\\n\");"}, {"source_line_num": 346, "source_line_code": "bc.getLength(), encoding);"}, {"source_line_num": 353, "source_line_code": "Enumeration<String> en= paramHashStringArray.keys();"}, {"source_line_num": 357, "source_line_code": "String v[] = paramHashStringArray.get( k );"}, {"source_line_num": 358, "source_line_code": "for( int i=0; i<v.length; i++ )"}, {"source_line_num": 359, "source_line_code": "sb.append( v[i] ).append(\",\");"}, {"source_line_num": 360, "source_line_code": "sb.append(\"\\n\");"}], "filename": "archive/tc7.0.x/trunk/java/org/apache/tomcat/util/http/Parameters.java", "patch_func": "no", "diff_file": "CVE-2012-0022_1189899.diff", "patch_tag": "7.0.23", "source_tag": "7.0.22"}]