[{"cve_id": "CVE-2013-4444", "added_line": [], "removed_line": [{"source_line_num": 650, "source_line_code": "private void writeObject(ObjectOutputStream out) throws IOException {"}, {"source_line_num": 652, "source_line_code": "if (dfos.isInMemory()) {"}, {"source_line_num": 653, "source_line_code": "cachedContent = get();"}, {"source_line_num": 654, "source_line_code": "} else {"}, {"source_line_num": 655, "source_line_code": "cachedContent = null;"}, {"source_line_num": 656, "source_line_code": "dfosFile = dfos.getFile();"}, {"source_line_num": 660, "source_line_code": "out.defaultWriteObject();"}, {"source_line_num": 671, "source_line_code": "private void readObject(ObjectInputStream in)"}, {"source_line_num": 672, "source_line_code": "throws IOException, ClassNotFoundException {"}, {"source_line_num": 674, "source_line_code": "in.defaultReadObject();"}, {"source_line_num": 676, "source_line_code": "OutputStream output = getOutputStream();"}, {"source_line_num": 677, "source_line_code": "if (cachedContent != null) {"}, {"source_line_num": 678, "source_line_code": "output.write(cachedContent);"}, {"source_line_num": 679, "source_line_code": "} else {"}, {"source_line_num": 680, "source_line_code": "FileInputStream input = new FileInputStream(dfosFile);"}, {"source_line_num": 681, "source_line_code": "IOUtils.copy(input, output);"}, {"source_line_num": 682, "source_line_code": "dfosFile.delete();"}, {"source_line_num": 683, "source_line_code": "dfosFile = null;"}, {"source_line_num": 685, "source_line_code": "output.close();"}, {"source_line_num": 687, "source_line_code": "cachedContent = null;"}, {"source_line_num": 650, "source_line_code": "private void writeObject(ObjectOutputStream out) throws IOException {"}, {"source_line_num": 652, "source_line_code": "if (dfos.isInMemory()) {"}, {"source_line_num": 653, "source_line_code": "cachedContent = get();"}, {"source_line_num": 656, "source_line_code": "} else {"}, {"source_line_num": 657, "source_line_code": "cachedContent = null;"}, {"source_line_num": 656, "source_line_code": "dfosFile = dfos.getFile();"}, {"source_line_num": 660, "source_line_code": "out.defaultWriteObject();"}, {"source_line_num": 671, "source_line_code": "private void readObject(ObjectInputStream in)"}, {"source_line_num": 672, "source_line_code": "throws IOException, ClassNotFoundException {"}, {"source_line_num": 674, "source_line_code": "in.defaultReadObject();"}, {"source_line_num": 676, "source_line_code": "OutputStream output = getOutputStream();"}, {"source_line_num": 677, "source_line_code": "if (cachedContent != null) {"}, {"source_line_num": 678, "source_line_code": "output.write(cachedContent);"}, {"source_line_num": 681, "source_line_code": "} else {"}, {"source_line_num": 680, "source_line_code": "FileInputStream input = new FileInputStream(dfosFile);"}, {"source_line_num": 681, "source_line_code": "IOUtils.copy(input, output);"}, {"source_line_num": 682, "source_line_code": "dfosFile.delete();"}, {"source_line_num": 683, "source_line_code": "dfosFile = null;"}, {"source_line_num": 685, "source_line_code": "output.close();"}, {"source_line_num": 689, "source_line_code": "cachedContent = null;"}], "filename": "archive/tc7.0.x/trunk/java/org/apache/tomcat/util/http/fileupload/disk/DiskFileItem.java", "patch_func": "no", "diff_file": "CVE-2013-4444_1470437.diff", "patch_tag": "7.0.40", "source_tag": "7.0.39"}]