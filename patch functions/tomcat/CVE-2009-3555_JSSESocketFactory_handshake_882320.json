[{"cve_id": "CVE-2009-3555", 
	"added_line": [
		{"target_line_num": 178, "target_line_code": "if (!allowUnsafeLegacyRenegotiation) {"}, 
		{"target_line_num": 180, "target_line_code": "((SSLSocket) sock).setEnabledCipherSuites(new String[0]);"}], 
	"removed_line": [
		{"source_line_num": 174, "source_line_code": "private static class DisableSslRenegotiation"}, 
		{"source_line_num": 175, "source_line_code": "implements HandshakeCompletedListener {"}, 
		{"source_line_num": 176, "source_line_code": "private volatile boolean completed = false;"}, 
		{"source_line_num": 178, "source_line_code": "public void handshakeCompleted(HandshakeCompletedEvent event) {"}, {"source_line_num": 179, "source_line_code": "if (completed) {"}, {"source_line_num": 180, "source_line_code": "try {"}, {"source_line_num": 181, "source_line_code": "log.warn(\"SSL renegotiation is disabled, closing connection\");"}, {"source_line_num": 182, "source_line_code": "event.getSession().invalidate();"}, {"source_line_num": 183, "source_line_code": "event.getSocket().close();"}, {"source_line_num": 184, "source_line_code": "} catch (IOException e) {"}, {"source_line_num": 188, "source_line_code": "completed = true;"}], "filename": "archive/trunk/java/org/apache/tomcat/util/net/jsse/JSSESocketFactory.java", "patch_func": "no", "diff_file": "CVE-2009-3555_882320.diff", "patch_tag": "6.0.24", "source_tag": "6.0.23"}]