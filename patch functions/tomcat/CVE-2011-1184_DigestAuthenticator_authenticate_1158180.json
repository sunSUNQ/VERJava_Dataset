[{"cve_id": "CVE-2011-1184", "added_line": [{"target_line_num": 265, "target_line_code": "DigestInfo digestInfo = new DigestInfo(getOpaque(), getNonceValidity(),"}, {"target_line_num": 266, "target_line_code": "getKey(), cnonces, isValidateUri());"}, {"target_line_num": 268, "target_line_code": "if (digestInfo.validate(request, authorization, config)) {"}, {"target_line_num": 269, "target_line_code": "principal = digestInfo.authenticate(context.getRealm());"}, {"target_line_num": 285, "target_line_code": "String nonce = generateNonce(request);"}, {"target_line_num": 287, "target_line_code": "setAuthenticateHeader(request, response, config, nonce,"}, {"target_line_num": 288, "target_line_code": "digestInfo.isNonceStale());"}, {"target_line_num": 265, "target_line_code": "DigestInfo digestInfo = new DigestInfo(getOpaque(), getNonceValidity(),"}, {"target_line_num": 266, "target_line_code": "getKey(), cnonces, isValidateUri());"}, {"target_line_num": 268, "target_line_code": "if (digestInfo.validate(request, authorization, config)) {"}, {"target_line_num": 269, "target_line_code": "principal = digestInfo.authenticate(context.getRealm());"}, {"target_line_num": 285, "target_line_code": "String nonce = generateNonce(request);"}, {"target_line_num": 287, "target_line_code": "setAuthenticateHeader(request, response, config, nonce,"}, {"target_line_num": 288, "target_line_code": "digestInfo.isNonceStale());"}], "removed_line": [{"source_line_num": 176, "source_line_code": "principal = findPrincipal(request, authorization, context.getRealm());"}, {"source_line_num": 190, "source_line_code": "String nOnce = generateNOnce(request);"}, {"source_line_num": 192, "source_line_code": "setAuthenticateHeader(request, response, config, nOnce);"}, {"source_line_num": 176, "source_line_code": "principal = findPrincipal(request, authorization, context.getRealm());"}, {"source_line_num": 190, "source_line_code": "String nOnce = generateNOnce(request);"}, {"source_line_num": 192, "source_line_code": "setAuthenticateHeader(request, response, config, nOnce);"}], "filename": "archive/tc6.0.x/trunk/java/org/apache/catalina/authenticator/DigestAuthenticator.java", "patch_func": "authenticate", "diff_file": "CVE-2011-1184_1158180.diff", "patch_tag": "6.0.33", "source_tag": "6.0.32"}]