[{"cve_id": "CVE-2008-2938", "added_line": [{"target_line_num": 798, "target_line_code": "public static boolean checkNormalize(MessageBytes uriMB) {"}, {"target_line_num": 800, "target_line_code": "CharChunk uriCC = uriMB.getCharChunk();"}, {"target_line_num": 801, "target_line_code": "char[] c = uriCC.getChars();"}, {"target_line_num": 802, "target_line_code": "int start = uriCC.getStart();"}, {"target_line_num": 803, "target_line_code": "int end = uriCC.getEnd();"}, {"target_line_num": 805, "target_line_code": "int pos = 0;"}, {"target_line_num": 808, "target_line_code": "for (pos = start; pos < end; pos++) {"}, {"target_line_num": 809, "target_line_code": "if (c[pos] == '\\\\') {"}, {"target_line_num": 810, "target_line_code": "return false;"}, {"target_line_num": 812, "target_line_code": "if (c[pos] == 0) {"}, {"target_line_num": 810, "target_line_code": "return false;"}, {"target_line_num": 818, "target_line_code": "for (pos = start; pos < (end - 1); pos++) {"}, {"target_line_num": 819, "target_line_code": "if (c[pos] == '/') {"}, {"target_line_num": 820, "target_line_code": "if (c[pos + 1] == '/') {"}, {"target_line_num": 810, "target_line_code": "return false;"}, {"target_line_num": 827, "target_line_code": "if (((end - start) >= 2) && (c[end - 1] == '.')) {"}, {"target_line_num": 828, "target_line_code": "if ((c[end - 2] == '/')"}, {"target_line_num": 829, "target_line_code": "|| ((c[end - 2] == '.')"}, {"target_line_num": 830, "target_line_code": "&& (c[end - 3] == '/'))) {"}, {"target_line_num": 831, "target_line_code": "return false;"}, {"target_line_num": 836, "target_line_code": "if (uriCC.indexOf(\"/./\", 0, 3, 0) >= 0) {"}, {"target_line_num": 831, "target_line_code": "return false;"}, {"target_line_num": 841, "target_line_code": "if (uriCC.indexOf(\"/../\", 0, 4, 0) >= 0) {"}, {"target_line_num": 831, "target_line_code": "return false;"}, {"target_line_num": 845, "target_line_code": "return true;"}, {"target_line_num": 798, "target_line_code": "public static boolean checkNormalize(MessageBytes uriMB) {"}, {"target_line_num": 800, "target_line_code": "CharChunk uriCC = uriMB.getCharChunk();"}, {"target_line_num": 801, "target_line_code": "char[] c = uriCC.getChars();"}, {"target_line_num": 802, "target_line_code": "int start = uriCC.getStart();"}, {"target_line_num": 803, "target_line_code": "int end = uriCC.getEnd();"}, {"target_line_num": 805, "target_line_code": "int pos = 0;"}, {"target_line_num": 808, "target_line_code": "for (pos = start; pos < end; pos++) {"}, {"target_line_num": 809, "target_line_code": "if (c[pos] == '\\\\') {"}, {"target_line_num": 812, "target_line_code": "return false;"}, {"target_line_num": 812, "target_line_code": "if (c[pos] == 0) {"}, {"target_line_num": 815, "target_line_code": "return false;"}, {"target_line_num": 818, "target_line_code": "for (pos = start; pos < (end - 1); pos++) {"}, {"target_line_num": 819, "target_line_code": "if (c[pos] == '/') {"}, {"target_line_num": 820, "target_line_code": "if (c[pos + 1] == '/') {"}, {"target_line_num": 823, "target_line_code": "return false;"}, {"target_line_num": 827, "target_line_code": "if (((end - start) >= 2) && (c[end - 1] == '.')) {"}, {"target_line_num": 828, "target_line_code": "if ((c[end - 2] == '/')"}, {"target_line_num": 829, "target_line_code": "|| ((c[end - 2] == '.')"}, {"target_line_num": 830, "target_line_code": "&& (c[end - 3] == '/'))) {"}, {"target_line_num": 833, "target_line_code": "return false;"}, {"target_line_num": 836, "target_line_code": "if (uriCC.indexOf(\"/./\", 0, 3, 0) >= 0) {"}, {"target_line_num": 839, "target_line_code": "return false;"}, {"target_line_num": 841, "target_line_code": "if (uriCC.indexOf(\"/../\", 0, 4, 0) >= 0) {"}, {"target_line_num": 844, "target_line_code": "return false;"}, {"target_line_num": 845, "target_line_code": "return true;"}], "removed_line": [], "filename": "archive/tc6.0.x/trunk/java/org/apache/catalina/connector/CoyoteAdapter.java", "patch_func": "checkNormalize", "diff_file": "CVE-2008-2938_678137.diff", "patch_tag": "6.0.18", "source_tag": "6.0.16"}]