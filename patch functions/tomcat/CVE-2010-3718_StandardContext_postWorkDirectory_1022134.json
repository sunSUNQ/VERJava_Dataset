[{"cve_id": "CVE-2010-3718", "added_line": [{"target_line_num": 5568, "target_line_code": "if (context == null) {"}, {"target_line_num": 5569, "target_line_code": "getServletContext();"}, {"target_line_num": 5571, "target_line_code": "context.setAttribute(ServletContext.TEMPDIR, dir);"}, {"target_line_num": 5572, "target_line_code": "context.setAttributeReadOnly(ServletContext.TEMPDIR);"}], "removed_line": [{"source_line_num": 5567, "source_line_code": "getServletContext().setAttribute(ServletContext.TEMPDIR, dir);"}, {"source_line_num": 5568, "source_line_code": "if (getServletContext() instanceof ApplicationContext)"}, {"source_line_num": 5569, "source_line_code": "((ApplicationContext) getServletContext()).setAttributeReadOnly"}, {"source_line_num": 5570, "source_line_code": "(ServletContext.TEMPDIR);"}], "filename": "archive/trunk/java/org/apache/catalina/core/StandardContext.java", "patch_func": "postWorkDirectory", "diff_file": "CVE-2010-3718_1022134.diff", "patch_tag": "7.0.4", "source_tag": "7.0.3"}]