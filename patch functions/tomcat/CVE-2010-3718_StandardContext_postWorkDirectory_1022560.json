[{"cve_id": "CVE-2010-3718", "added_line": [{"target_line_num": 5345, "target_line_code": "if (context == null) {"}, {"target_line_num": 5346, "target_line_code": "getServletContext();"}, {"target_line_num": 5348, "target_line_code": "context.setAttribute(Globals.WORK_DIR_ATTR, dir);"}, {"target_line_num": 5349, "target_line_code": "context.setAttributeReadOnly(Globals.WORK_DIR_ATTR);"}], 
	"removed_line": [
		{"source_line_num": 5344, "source_line_code": "getServletContext().setAttribute(Globals.WORK_DIR_ATTR, dir);"}, 
		{"source_line_num": 5345, "source_line_code": "if (getServletContext() instanceof ApplicationContext)"}, 
		{"source_line_num": 5346, "source_line_code": "((ApplicationContext) getServletContext()).setAttributeReadOnly"}, 
		{"source_line_num": 5347, "source_line_code": "(Globals.WORK_DIR_ATTR);"}], "filename": "archive/tc6.0.x/trunk/java/org/apache/catalina/core/StandardContext.java", "patch_func": "postWorkDirectory", "diff_file": "CVE-2010-3718_1022560.diff", "patch_tag": "6.0.30", "source_tag": "6.0.29"}]