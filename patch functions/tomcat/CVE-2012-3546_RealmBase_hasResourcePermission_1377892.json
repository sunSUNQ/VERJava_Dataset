[{"cve_id": "CVE-2012-3546", "added_line": [], "removed_line": [{"source_line_num": 824, "source_line_code": "LoginConfig config = context.getLoginConfig();"}, {"source_line_num": 825, "source_line_code": "if ((config != null) &&"}, {"source_line_num": 826, "source_line_code": "(Constants.FORM_METHOD.equals(config.getAuthMethod()))) {"}, {"source_line_num": 827, "source_line_code": "String requestURI = request.getRequestPathMB().toString();"}, {"source_line_num": 828, "source_line_code": "String loginPage = config.getLoginPage();"}, {"source_line_num": 829, "source_line_code": "if (loginPage.equals(requestURI)) {"}, {"source_line_num": 830, "source_line_code": "if (log.isDebugEnabled())"}, {"source_line_num": 831, "source_line_code": "log.debug(\" Allow access to login page \" + loginPage);"}, {"source_line_num": 832, "source_line_code": "return (true);"}, {"source_line_num": 834, "source_line_code": "String errorPage = config.getErrorPage();"}, {"source_line_num": 835, "source_line_code": "if (errorPage.equals(requestURI)) {"}, {"source_line_num": 830, "source_line_code": "if (log.isDebugEnabled())"}, {"source_line_num": 837, "source_line_code": "log.debug(\" Allow access to error page \" + errorPage);"}, {"source_line_num": 832, "source_line_code": "return (true);"}, {"source_line_num": 840, "source_line_code": "if (requestURI.endsWith(Constants.FORM_ACTION)) {"}, {"source_line_num": 830, "source_line_code": "if (log.isDebugEnabled())"}, {"source_line_num": 842, "source_line_code": "log.debug(\" Allow access to username/password submission\");"}, {"source_line_num": 832, "source_line_code": "return (true);"}, {"source_line_num": 824, "source_line_code": "LoginConfig config = context.getLoginConfig();"}, {"source_line_num": 825, "source_line_code": "if ((config != null) &&"}, {"source_line_num": 826, "source_line_code": "(Constants.FORM_METHOD.equals(config.getAuthMethod()))) {"}, {"source_line_num": 827, "source_line_code": "String requestURI = request.getRequestPathMB().toString();"}, {"source_line_num": 828, "source_line_code": "String loginPage = config.getLoginPage();"}, {"source_line_num": 829, "source_line_code": "if (loginPage.equals(requestURI)) {"}, {"source_line_num": 830, "source_line_code": "if (log.isDebugEnabled())"}, {"source_line_num": 831, "source_line_code": "log.debug(\" Allow access to login page \" + loginPage);"}, {"source_line_num": 832, "source_line_code": "return (true);"}, {"source_line_num": 834, "source_line_code": "String errorPage = config.getErrorPage();"}, {"source_line_num": 835, "source_line_code": "if (errorPage.equals(requestURI)) {"}, {"source_line_num": 830, "source_line_code": "if (log.isDebugEnabled())"}, {"source_line_num": 837, "source_line_code": "log.debug(\" Allow access to error page \" + errorPage);"}, {"source_line_num": 832, "source_line_code": "return (true);"}, {"source_line_num": 840, "source_line_code": "if (requestURI.endsWith(Constants.FORM_ACTION)) {"}, {"source_line_num": 830, "source_line_code": "if (log.isDebugEnabled())"}, {"source_line_num": 842, "source_line_code": "log.debug(\" Allow access to username/password submission\");"}, {"source_line_num": 832, "source_line_code": "return (true);"}], "filename": "archive/tc7.0.x/trunk/java/org/apache/catalina/realm/RealmBase.java", "patch_func": "hasResourcePermission", "diff_file": "CVE-2012-3546_1377892.diff", "patch_tag": "7.0.30", "source_tag": "7.0.29"}]