[{"cve_id": "CVE-2008-2938", "added_line": [{"target_line_num": 652, "target_line_code": "public static boolean checkNormalize(MessageBytes uriMB) {"}, {"target_line_num": 654, "target_line_code": "CharChunk uriCC = uriMB.getCharChunk();"}, {"target_line_num": 655, "target_line_code": "char[] c = uriCC.getChars();"}, {"target_line_num": 656, "target_line_code": "int start = uriCC.getStart();"}, {"target_line_num": 657, "target_line_code": "int end = uriCC.getEnd();"}, {"target_line_num": 659, "target_line_code": "int pos = 0;"}, {"target_line_num": 662, "target_line_code": "for (pos = start; pos < end; pos++) {"}, {"target_line_num": 663, "target_line_code": "if (c[pos] == '\\\\') {"}, {"target_line_num": 664, "target_line_code": "return false;"}, {"target_line_num": 666, "target_line_code": "if (c[pos] == 0) {"}, {"target_line_num": 667, "target_line_code": "return false;"}, {"target_line_num": 672, "target_line_code": "for (pos = start; pos < (end - 1); pos++) {"}, {"target_line_num": 673, "target_line_code": "if (c[pos] == '/') {"}, {"target_line_num": 674, "target_line_code": "if (c[pos + 1] == '/') {"}, {"target_line_num": 675, "target_line_code": "return false;"}, {"target_line_num": 681, "target_line_code": "if (((end - start) >= 2) && (c[end - 1] == '.')) {"}, {"target_line_num": 682, "target_line_code": "if ((c[end - 2] == '/')"}, {"target_line_num": 683, "target_line_code": "|| ((c[end - 2] == '.')"}, {"target_line_num": 684, "target_line_code": "&& (c[end - 3] == '/'))) {"}, {"target_line_num": 685, "target_line_code": "return false;"}, {"target_line_num": 690, "target_line_code": "if (uriCC.indexOf(\"/./\", 0, 3, 0) >= 0) {"}, {"target_line_num": 691, "target_line_code": "return false;"}, {"target_line_num": 695, "target_line_code": "if (uriCC.indexOf(\"/../\", 0, 4, 0) >= 0) {"}, {"target_line_num": 696, "target_line_code": "return false;"}, {"target_line_num": 702, "target_line_code": "return true;"}, {"target_line_num": 702, "target_line_code": "return true;"}], "removed_line": [], "filename": "archive/container/tc5.5.x/catalina/src/share/org/apache/catalina/connector/CoyoteAdapter.java", "patch_func": "checkNormalize", "diff_file": "CVE-2008-2938_681029.diff", "patch_tag": "6.0.20", "source_tag": "6.0.18"}]