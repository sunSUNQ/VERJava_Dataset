[{"cve_id": "CVE-2012-0022", "added_line": [{"target_line_num": 110, "target_line_code": "ArrayList<String> values;"}, {"target_line_num": 111, "target_line_code": "if (paramHashValues.containsKey(key)) {"}, {"target_line_num": 112, "target_line_code": "values = paramHashValues.get(key);"}, {"target_line_num": 114, "target_line_code": "values = new ArrayList<String>(1);"}, {"target_line_num": 115, "target_line_code": "paramHashValues.put(key, values);"}, {"target_line_num": 118, "target_line_code": "values.ensureCapacity(values.size() + newValues.length);"}, {"target_line_num": 119, "target_line_code": "for (String newValue : newValues) {"}, {"target_line_num": 120, "target_line_code": "values.add(newValue);"}, {"target_line_num": 127, "target_line_code": "ArrayList<String> values = paramHashValues.get(name);"}, {"target_line_num": 128, "target_line_code": "return values.toArray(new String[values.size()]);"}, {"target_line_num": 133, "target_line_code": "return paramHashValues.keys();"}, {"target_line_num": 138, "target_line_code": "ArrayList<String> values = paramHashValues.get(name);"}, {"target_line_num": 140, "target_line_code": "if(values.size() == 0) {"}, {"target_line_num": 141, "target_line_code": "return \"\";"}, {"target_line_num": 143, "target_line_code": "return values.get(0);"}], "removed_line": [{"source_line_num": 96, "source_line_code": "String values[];"}, {"source_line_num": 97, "source_line_code": "if (paramHashStringArray.containsKey(key)) {"}, {"source_line_num": 98, "source_line_code": "String oldValues[] = paramHashStringArray.get(key);"}, {"source_line_num": 99, "source_line_code": "values = new String[oldValues.length + newValues.length];"}, {"source_line_num": 100, "source_line_code": "for (int i = 0; i < oldValues.length; i++) {"}, {"source_line_num": 101, "source_line_code": "values[i] = oldValues[i];"}, {"source_line_num": 103, "source_line_code": "for (int i = 0; i < newValues.length; i++) {"}, {"source_line_num": 104, "source_line_code": "values[i+ oldValues.length] = newValues[i];"}, {"source_line_num": 107, "source_line_code": "values = newValues;"}, {"source_line_num": 110, "source_line_code": "paramHashStringArray.put(key, values);"}, {"source_line_num": 116, "source_line_code": "String values[] = paramHashStringArray.get(name);"}, {"source_line_num": 117, "source_line_code": "return values;"}, {"source_line_num": 122, "source_line_code": "return paramHashStringArray.keys();"}, {"source_line_num": 127, "source_line_code": "String[] values = getParameterValues(name);"}, {"source_line_num": 129, "source_line_code": "if( values.length==0 ) return \"\";"}, {"source_line_num": 130, "source_line_code": "return values[0];"}, {"source_line_num": 96, "source_line_code": "String values[];"}, {"source_line_num": 97, "source_line_code": "if (paramHashStringArray.containsKey(key)) {"}, {"source_line_num": 98, "source_line_code": "String oldValues[] = paramHashStringArray.get(key);"}, {"source_line_num": 99, "source_line_code": "values = new String[oldValues.length + newValues.length];"}, {"source_line_num": 100, "source_line_code": "for (int i = 0; i < oldValues.length; i++) {"}, {"source_line_num": 101, "source_line_code": "values[i] = oldValues[i];"}, {"source_line_num": 103, "source_line_code": "for (int i = 0; i < newValues.length; i++) {"}, {"source_line_num": 104, "source_line_code": "values[i+ oldValues.length] = newValues[i];"}, {"source_line_num": 107, "source_line_code": "values = newValues;"}, {"source_line_num": 110, "source_line_code": "paramHashStringArray.put(key, values);"}, {"source_line_num": 116, "source_line_code": "String values[] = paramHashStringArray.get(name);"}, {"source_line_num": 117, "source_line_code": "return values;"}, {"source_line_num": 122, "source_line_code": "return paramHashStringArray.keys();"}, {"source_line_num": 127, "source_line_code": "String[] values = getParameterValues(name);"}, {"source_line_num": 129, "source_line_code": "if( values.length==0 ) return \"\";"}, {"source_line_num": 130, "source_line_code": "return values[0];"}], "filename": "archive/tc7.0.x/trunk/java/org/apache/tomcat/util/http/Parameters.java", "patch_func": "no", "diff_file": "CVE-2012-0022_1189899.diff", "patch_tag": "7.0.23", "source_tag": "7.0.22"}]