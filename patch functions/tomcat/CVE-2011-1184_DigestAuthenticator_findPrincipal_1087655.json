[{"cve_id": "CVE-2011-1184", "added_line": [], "removed_line": [{"source_line_num": 220, "source_line_code": "protected static Principal findPrincipal(Request request,"}, {"source_line_num": 221, "source_line_code": "String authorization,"}, {"source_line_num": 222, "source_line_code": "Realm realm) {"}, {"source_line_num": 226, "source_line_code": "if (authorization == null)"}, {"source_line_num": 227, "source_line_code": "return (null);"}, {"source_line_num": 228, "source_line_code": "if (!authorization.startsWith(\"Digest \"))"}, {"source_line_num": 227, "source_line_code": "return (null);"}, {"source_line_num": 230, "source_line_code": "authorization = authorization.substring(7).trim();"}, {"source_line_num": 233, "source_line_code": "String[] tokens = authorization.split(\",(?=(?:[^\\\"]*\\\"[^\\\"]*\\\")+$)\");"}, {"source_line_num": 235, "source_line_code": "String userName = null;"}, {"source_line_num": 236, "source_line_code": "String realmName = null;"}, {"source_line_num": 237, "source_line_code": "String nOnce = null;"}, {"source_line_num": 238, "source_line_code": "String nc = null;"}, {"source_line_num": 239, "source_line_code": "String cnonce = null;"}, {"source_line_num": 240, "source_line_code": "String qop = null;"}, {"source_line_num": 241, "source_line_code": "String uri = null;"}, {"source_line_num": 242, "source_line_code": "String response = null;"}, {"source_line_num": 243, "source_line_code": "String method = request.getMethod();"}, {"source_line_num": 245, "source_line_code": "for (int i = 0; i < tokens.length; i++) {"}, {"source_line_num": 246, "source_line_code": "String currentToken = tokens[i];"}, {"source_line_num": 247, "source_line_code": "if (currentToken.length() == 0)"}, {"source_line_num": 248, "source_line_code": "continue;"}, {"source_line_num": 250, "source_line_code": "int equalSign = currentToken.indexOf('=');"}, {"source_line_num": 251, "source_line_code": "if (equalSign < 0)"}, {"source_line_num": 252, "source_line_code": "return null;"}, {"source_line_num": 253, "source_line_code": "String currentTokenName ="}, {"source_line_num": 254, "source_line_code": "currentToken.substring(0, equalSign).trim();"}, {"source_line_num": 255, "source_line_code": "String currentTokenValue ="}, {"source_line_num": 256, "source_line_code": "currentToken.substring(equalSign + 1).trim();"}, {"source_line_num": 257, "source_line_code": "if (\"username\".equals(currentTokenName))"}, {"source_line_num": 258, "source_line_code": "userName = removeQuotes(currentTokenValue);"}, {"source_line_num": 259, "source_line_code": "if (\"realm\".equals(currentTokenName))"}, {"source_line_num": 260, "source_line_code": "realmName = removeQuotes(currentTokenValue, true);"}, {"source_line_num": 261, "source_line_code": "if (\"nonce\".equals(currentTokenName))"}, {"source_line_num": 262, "source_line_code": "nOnce = removeQuotes(currentTokenValue);"}, {"source_line_num": 263, "source_line_code": "if (\"nc\".equals(currentTokenName))"}, {"source_line_num": 264, "source_line_code": "nc = removeQuotes(currentTokenValue);"}, {"source_line_num": 265, "source_line_code": "if (\"cnonce\".equals(currentTokenName))"}, {"source_line_num": 266, "source_line_code": "cnonce = removeQuotes(currentTokenValue);"}, {"source_line_num": 267, "source_line_code": "if (\"qop\".equals(currentTokenName))"}, {"source_line_num": 268, "source_line_code": "qop = removeQuotes(currentTokenValue);"}, {"source_line_num": 269, "source_line_code": "if (\"uri\".equals(currentTokenName))"}, {"source_line_num": 270, "source_line_code": "uri = removeQuotes(currentTokenValue);"}, {"source_line_num": 271, "source_line_code": "if (\"response\".equals(currentTokenName))"}, {"source_line_num": 272, "source_line_code": "response = removeQuotes(currentTokenValue);"}, {"source_line_num": 275, "source_line_code": "if ( (userName == null) || (realmName == null) || (nOnce == null)"}, {"source_line_num": 276, "source_line_code": "|| (uri == null) || (response == null) )"}, {"source_line_num": 277, "source_line_code": "return null;"}, {"source_line_num": 281, "source_line_code": "String a2 = method + \":\" + uri;"}, {"source_line_num": 284, "source_line_code": "byte[] buffer = null;"}, {"source_line_num": 285, "source_line_code": "synchronized (md5Helper) {"}, {"source_line_num": 286, "source_line_code": "buffer = md5Helper.digest(a2.getBytes());"}, {"source_line_num": 288, "source_line_code": "String md5a2 = md5Encoder.encode(buffer);"}, {"source_line_num": 290, "source_line_code": "return (realm.authenticate(userName, response, nOnce, nc, cnonce, qop,"}, {"source_line_num": 291, "source_line_code": "realmName, md5a2));"}, {"source_line_num": 220, "source_line_code": "protected static Principal findPrincipal(Request request,"}, {"source_line_num": 221, "source_line_code": "String authorization,"}, {"source_line_num": 222, "source_line_code": "Realm realm) {"}, {"source_line_num": 226, "source_line_code": "if (authorization == null)"}, {"source_line_num": 227, "source_line_code": "return (null);"}, {"source_line_num": 228, "source_line_code": "if (!authorization.startsWith(\"Digest \"))"}, {"source_line_num": 227, "source_line_code": "return (null);"}, {"source_line_num": 230, "source_line_code": "authorization = authorization.substring(7).trim();"}, {"source_line_num": 233, "source_line_code": "String[] tokens = authorization.split(\",(?=(?:[^\\\"]*\\\"[^\\\"]*\\\")+$)\");"}, {"source_line_num": 235, "source_line_code": "String userName = null;"}, {"source_line_num": 236, "source_line_code": "String realmName = null;"}, {"source_line_num": 237, "source_line_code": "String nOnce = null;"}, {"source_line_num": 238, "source_line_code": "String nc = null;"}, {"source_line_num": 239, "source_line_code": "String cnonce = null;"}, {"source_line_num": 240, "source_line_code": "String qop = null;"}, {"source_line_num": 241, "source_line_code": "String uri = null;"}, {"source_line_num": 242, "source_line_code": "String response = null;"}, {"source_line_num": 243, "source_line_code": "String method = request.getMethod();"}, {"source_line_num": 245, "source_line_code": "for (int i = 0; i < tokens.length; i++) {"}, {"source_line_num": 246, "source_line_code": "String currentToken = tokens[i];"}, {"source_line_num": 247, "source_line_code": "if (currentToken.length() == 0)"}, {"source_line_num": 248, "source_line_code": "continue;"}, {"source_line_num": 250, "source_line_code": "int equalSign = currentToken.indexOf('=');"}, {"source_line_num": 251, "source_line_code": "if (equalSign < 0)"}, {"source_line_num": 254, "source_line_code": "return null;"}, {"source_line_num": 253, "source_line_code": "String currentTokenName ="}, {"source_line_num": 254, "source_line_code": "currentToken.substring(0, equalSign).trim();"}, {"source_line_num": 255, "source_line_code": "String currentTokenValue ="}, {"source_line_num": 256, "source_line_code": "currentToken.substring(equalSign + 1).trim();"}, {"source_line_num": 257, "source_line_code": "if (\"username\".equals(currentTokenName))"}, {"source_line_num": 258, "source_line_code": "userName = removeQuotes(currentTokenValue);"}, {"source_line_num": 259, "source_line_code": "if (\"realm\".equals(currentTokenName))"}, {"source_line_num": 260, "source_line_code": "realmName = removeQuotes(currentTokenValue, true);"}, {"source_line_num": 261, "source_line_code": "if (\"nonce\".equals(currentTokenName))"}, {"source_line_num": 262, "source_line_code": "nOnce = removeQuotes(currentTokenValue);"}, {"source_line_num": 263, "source_line_code": "if (\"nc\".equals(currentTokenName))"}, {"source_line_num": 264, "source_line_code": "nc = removeQuotes(currentTokenValue);"}, {"source_line_num": 265, "source_line_code": "if (\"cnonce\".equals(currentTokenName))"}, {"source_line_num": 266, "source_line_code": "cnonce = removeQuotes(currentTokenValue);"}, {"source_line_num": 267, "source_line_code": "if (\"qop\".equals(currentTokenName))"}, {"source_line_num": 268, "source_line_code": "qop = removeQuotes(currentTokenValue);"}, {"source_line_num": 269, "source_line_code": "if (\"uri\".equals(currentTokenName))"}, {"source_line_num": 270, "source_line_code": "uri = removeQuotes(currentTokenValue);"}, {"source_line_num": 271, "source_line_code": "if (\"response\".equals(currentTokenName))"}, {"source_line_num": 272, "source_line_code": "response = removeQuotes(currentTokenValue);"}, {"source_line_num": 275, "source_line_code": "if ( (userName == null) || (realmName == null) || (nOnce == null)"}, {"source_line_num": 276, "source_line_code": "|| (uri == null) || (response == null) )"}, {"source_line_num": 279, "source_line_code": "return null;"}, {"source_line_num": 281, "source_line_code": "String a2 = method + \":\" + uri;"}, {"source_line_num": 284, "source_line_code": "byte[] buffer = null;"}, {"source_line_num": 285, "source_line_code": "synchronized (md5Helper) {"}, {"source_line_num": 286, "source_line_code": "buffer = md5Helper.digest(a2.getBytes());"}, {"source_line_num": 288, "source_line_code": "String md5a2 = md5Encoder.encode(buffer);"}, {"source_line_num": 290, "source_line_code": "return (realm.authenticate(userName, response, nOnce, nc, cnonce, qop,"}, {"source_line_num": 291, "source_line_code": "realmName, md5a2));"}], "filename": "archive/trunk/java/org/apache/catalina/authenticator/DigestAuthenticator.java", "patch_func": "findPrincipal", "diff_file": "CVE-2011-1184_1087655.diff", "patch_tag": "7.0.12", "source_tag": "7.0.11"}]