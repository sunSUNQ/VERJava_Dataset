[{"cve_id": "CVE-2012-0022", "added_line": [{"target_line_num": 192, "target_line_code": "ArrayList<String> values = paramHashValues.get(key);"}, {"target_line_num": 193, "target_line_code": "if (values == null) {"}, {"target_line_num": 194, "target_line_code": "values = new ArrayList<String>(1);"}, {"target_line_num": 195, "target_line_code": "paramHashValues.put(key, values);"}, {"target_line_num": 197, "target_line_code": "values.add(value);"}, {"target_line_num": 192, "target_line_code": "ArrayList<String> values = paramHashValues.get(key);"}, {"target_line_num": 193, "target_line_code": "if (values == null) {"}, {"target_line_num": 194, "target_line_code": "values = new ArrayList<String>(1);"}, {"target_line_num": 195, "target_line_code": "paramHashValues.put(key, values);"}, {"target_line_num": 197, "target_line_code": "values.add(value);"}], "removed_line": [{"source_line_num": 273, "source_line_code": "/** Combine 2 hashtables into a new one."}, {"source_line_num": 278, "source_line_code": "private static void merge2(Hashtable<String,String[]> one,"}, {"source_line_num": 279, "source_line_code": "Hashtable<String,String[]> two ) {"}, {"source_line_num": 280, "source_line_code": "Enumeration e = two.keys();"}, {"source_line_num": 282, "source_line_code": "while (e.hasMoreElements()) {"}, {"source_line_num": 283, "source_line_code": "String name = (String) e.nextElement();"}, {"source_line_num": 284, "source_line_code": "String[] oneValue = one.get(name);"}, {"source_line_num": 285, "source_line_code": "String[] twoValue = two.get(name);"}, {"source_line_num": 286, "source_line_code": "String[] combinedValue;"}, {"source_line_num": 288, "source_line_code": "if (twoValue == null) {"}, {"source_line_num": 289, "source_line_code": "continue;"}, {"source_line_num": 290, "source_line_code": "} else {"}, {"source_line_num": 291, "source_line_code": "if( oneValue==null ) {"}, {"source_line_num": 292, "source_line_code": "combinedValue = new String[twoValue.length];"}, {"source_line_num": 293, "source_line_code": "System.arraycopy(twoValue, 0, combinedValue,"}, {"source_line_num": 294, "source_line_code": "0, twoValue.length);"}, {"source_line_num": 290, "source_line_code": "} else {"}, {"source_line_num": 296, "source_line_code": "combinedValue = new String[oneValue.length +"}, {"source_line_num": 297, "source_line_code": "twoValue.length];"}, {"source_line_num": 298, "source_line_code": "System.arraycopy(oneValue, 0, combinedValue, 0,"}, {"source_line_num": 299, "source_line_code": "oneValue.length);"}, {"source_line_num": 293, "source_line_code": "System.arraycopy(twoValue, 0, combinedValue,"}, {"source_line_num": 301, "source_line_code": "oneValue.length, twoValue.length);"}, {"source_line_num": 303, "source_line_code": "one.put(name, combinedValue);"}, {"source_line_num": 312, "source_line_code": "String values[];"}, {"source_line_num": 313, "source_line_code": "if (paramHashStringArray.containsKey(key)) {"}, {"source_line_num": 314, "source_line_code": "String oldValues[] = (String[])paramHashStringArray."}, {"source_line_num": 315, "source_line_code": "get(key);"}, {"source_line_num": 316, "source_line_code": "values = new String[oldValues.length + 1];"}, {"source_line_num": 317, "source_line_code": "for (int i = 0; i < oldValues.length; i++) {"}, {"source_line_num": 318, "source_line_code": "values[i] = oldValues[i];"}, {"source_line_num": 320, "source_line_code": "values[oldValues.length] = value;"}, {"source_line_num": 321, "source_line_code": "} else {"}, {"source_line_num": 322, "source_line_code": "values = new String[1];"}, {"source_line_num": 323, "source_line_code": "values[0] = value;"}, {"source_line_num": 327, "source_line_code": "paramHashStringArray.put(key, values);"}, {"source_line_num": 273, "source_line_code": "/** Combine 2 hashtables into a new one."}, {"source_line_num": 278, "source_line_code": "private static void merge2(Hashtable<String,String[]> one,"}, {"source_line_num": 279, "source_line_code": "Hashtable<String,String[]> two ) {"}, {"source_line_num": 280, "source_line_code": "Enumeration e = two.keys();"}, {"source_line_num": 282, "source_line_code": "while (e.hasMoreElements()) {"}, {"source_line_num": 283, "source_line_code": "String name = (String) e.nextElement();"}, {"source_line_num": 284, "source_line_code": "String[] oneValue = one.get(name);"}, {"source_line_num": 285, "source_line_code": "String[] twoValue = two.get(name);"}, {"source_line_num": 286, "source_line_code": "String[] combinedValue;"}, {"source_line_num": 288, "source_line_code": "if (twoValue == null) {"}, {"source_line_num": 289, "source_line_code": "continue;"}, {"source_line_num": 292, "source_line_code": "} else {"}, {"source_line_num": 291, "source_line_code": "if( oneValue==null ) {"}, {"source_line_num": 292, "source_line_code": "combinedValue = new String[twoValue.length];"}, {"source_line_num": 293, "source_line_code": "System.arraycopy(twoValue, 0, combinedValue,"}, {"source_line_num": 294, "source_line_code": "0, twoValue.length);"}, {"source_line_num": 297, "source_line_code": "} else {"}, {"source_line_num": 296, "source_line_code": "combinedValue = new String[oneValue.length +"}, {"source_line_num": 297, "source_line_code": "twoValue.length];"}, {"source_line_num": 298, "source_line_code": "System.arraycopy(oneValue, 0, combinedValue, 0,"}, {"source_line_num": 299, "source_line_code": "oneValue.length);"}, {"source_line_num": 293, "source_line_code": "System.arraycopy(twoValue, 0, combinedValue,"}, {"source_line_num": 301, "source_line_code": "oneValue.length, twoValue.length);"}, {"source_line_num": 303, "source_line_code": "one.put(name, combinedValue);"}, {"source_line_num": 312, "source_line_code": "String values[];"}, {"source_line_num": 313, "source_line_code": "if (paramHashStringArray.containsKey(key)) {"}, {"source_line_num": 314, "source_line_code": "String oldValues[] = (String[])paramHashStringArray."}, {"source_line_num": 315, "source_line_code": "get(key);"}, {"source_line_num": 316, "source_line_code": "values = new String[oldValues.length + 1];"}, {"source_line_num": 317, "source_line_code": "for (int i = 0; i < oldValues.length; i++) {"}, {"source_line_num": 318, "source_line_code": "values[i] = oldValues[i];"}, {"source_line_num": 320, "source_line_code": "values[oldValues.length] = value;"}, {"source_line_num": 323, "source_line_code": "} else {"}, {"source_line_num": 322, "source_line_code": "values = new String[1];"}, {"source_line_num": 323, "source_line_code": "values[0] = value;"}, {"source_line_num": 327, "source_line_code": "paramHashStringArray.put(key, values);"}], "filename": "archive/tc6.0.x/trunk/java/org/apache/tomcat/util/http/Parameters.java", "patch_func": "no", "diff_file": "CVE-2012-0022_1200601.diff", "patch_tag": "6.0.35", "source_tag": "6.0.33"}]